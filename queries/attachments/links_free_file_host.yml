name: "Attachment with links to free file sharing service"
type: "query"
source: |
  distinct(filter(
    map(attachments,
        map(beta.binexplode(.),
            map(filter(.scan.url.urls, .domain.root_domain in $free_file_hosts), .url)
        )
    ),
    length(.) > 0
  ))
severity: "medium"
