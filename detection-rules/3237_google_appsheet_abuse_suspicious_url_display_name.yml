name: "Google AppSheet abuse with suspicious indicators"
description: "Detects emails from noreply@appsheet.com that contain suspicious elements including organizational names in the subject, newly registered domains, free file hosting services, URL shorteners, or legal/compliance-related display names that may indicate impersonation or abuse of the legitimate AppSheet service."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and sender.email.email == "noreply@appsheet.com"
  and (
    (
      any($org_display_names, strings.contains(subject.base, .))
      or any($org_slds, strings.contains(subject.base, .))
    )
    or (
      any(body.links,
          network.whois(.href_url.domain).days_old <= 10
          or (
            .href_url.domain.root_domain in $free_file_hosts
            and not .href_url.domain.root_domain == "appsheet.com"
          )
          or .href_url.domain.domain in $free_subdomain_hosts
          or .href_url.domain.root_domain in $url_shorteners
      )
    )
    or regex.icontains(sender.display_name, '(?:legal|misuse|compliance)')
  )

attack_types:
  - "BEC/Fraud"
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Free file host"
  - "Free subdomain host"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
  - "URL analysis"
  - "Whois"
id: "1ac80dac-39e4-5d95-8f7e-e764a6db4420"
og_id: "fbb2f453-1d54-56b1-8ff2-cd45f4964347"
testing_pr: 3237
testing_sha: 4ef7da42aa459ad0f12ec9fbef5306996924dcaf