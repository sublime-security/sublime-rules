name: "Link: Google Translate (unsolicited)"
description: |
  Attackers have used the Google Translate service to deliver links to malicious sites repackaged with a translate.goog top-level domain.
  This rule identifies instances of Google Translate links from unsolicited senders.
references:
  - "https://www.kaspersky.com/blog/google-translate-scheme/46377/"
type: "rule"
authors:
  - twitter: "ajpc500"
severity: "low"
source: |
  type.inbound
  and any(body.links,
      ("google_translate_open_redirect") in .href_url.rewrite.encoders
      or .href_url.url == "translate.goog"
  )
  and not (
    any(ml.nlu_classifier(body.current_thread.text).topics,
        .name in (
          "Newsletters and Digests",
          "Advertising and Promotions",
          "Educational and Research",
          "B2B Cold Outreach",
          "Health and Wellness",
          "Professional and Career Development",
          "Romance",
          "Sexually Explicit Messages",
          "Software and App Updates",
          "Acts of Violence",
          "Voicemail Call and Missed Call Notifications",
          "Environmental and Sustainability",
          "Government Services",
          "Political Mail",
          "Emergency Alerts",
          "Customer Service and Support"
        )
        and .confidence == "high"
    )
  )
  // negate highly trusted sender domains unless they fail DMARC authentication
  and (
    (
      sender.email.domain.root_domain in $high_trust_sender_root_domains
      and not headers.auth_summary.dmarc.pass
    )
    or sender.email.domain.root_domain not in $high_trust_sender_root_domains
  )
  and sender.email.domain.root_domain != "govdelivery.com"
  and not profile.by_sender().any_messages_benign
tags:
  - "Attack surface reduction"
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Open redirect"
detection_methods:
  - "Sender analysis"
  - "URL analysis"
id: "e57a323c-33cd-5b71-97df-09bd92f72259"
og_id: "6949e115-b806-56ea-8976-420bb9d47e5c"
testing_pr: 2878
testing_sha: a6efd72861226276363024c36f3e36c5eca4372a