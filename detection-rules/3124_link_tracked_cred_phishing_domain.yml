name: "Link: Observed tracked actor credential phishing domain in link"
description: "Detects inbound messages containing links to domains whose SHA256 hashes match a predefined list of known malicious indicators. The rule checks both the full domain and root domain hashes against a comprehensive list of observered threat actor infrastructure."
type: "rule"
severity: "high"
references:
  - "https://sublime.security/blog/aitm-phishing-with-russian-infrastructure-and-detection-evasion-from-a-lapsed-domain"
source: |
  type.inbound
  and any(body.links,
          any([
                hash.sha256(.href_url.domain.domain),
                hash.sha256(.href_url.domain.root_domain)
              ],
              . in (
                "bf48de52f5f1cfbdb141dc5154a0a068ec5cdf1c734dfd2d0341558765b3a891",
                "e349443511cdec2176fd25e7823946b1d7bea0a7d9dd57f11fbea6b7e2a45bac",
                "b0019196a1a1b7ba6074f0b72a888d6db67f90604651e437053b5d46dd144322",
                "e59f110d8c1d30625d2e94532e2c14eab67bccd079b21fa7fc8b7ecca3782d97",
                "5be908a1b5598f698ed141ddf924d8e0510dee71c99565478759a207a6306150",
                "03a9e5ad2d5c54d08a2271be73309f23771accf42cb07b04e6addb8f091d3f24",
                "67f0365dba4c75abe7234ed5331058f3c3646a5ed2de9c9c54ee23504677a5cb",
                "f6cb0fa4ccc8ed164fea29b669e79006eddeabf34fd521c232acfe3c77e740d5",
                "c1117f244c25304baa7613bbb13c9d57610a6a0d837ce775a1dcff00f37e3c03",
                "00b508774dc5ee6569b46e933bf046da9f660c44651089d862bdc5995f4d43bb",
                "d51f29775732b9656d8bd7b4efdbcfb07952be4e5b60c5cee019fc0dca7d0946",
                "a93d38ecde67fbb451cb100767d25548f908e5c6a2f1f403a16f42edf9c5bb7b",
                "3a93a0bfcd98a98a65aed03220ddc97acbbe204a09a687ec6a6e25fd620206be",
                "16dd41af23db2094f5172b3dacac6d1d9b77d9f1d8ab0216b0eeab825abcaa0e",
                "3fbaadad4e95301412eaa133c7315979b8ad0256a27ca5f8266782dc6b0670ea",
                "064e91b68017e907942c4dd30cae8dbecebc3d28f3bd0ade2e365ead79570e91",
                "5b1d4ac386f7be761432549dee0fe56e50acc9a371ef3f299bce98ab160ea298",
                "cea095ee03f867fcbeb18688261dcc7a4bb5ec094ad89907fe7b732443ad9523",
                "389f487de9cdd2a348e9815d1e5a06f1a54f5ecd6e5281ef06f00f283857d805",
                "108ea7daac8631dc2f391c46397726b5fc0b1c755b3d4689d42d6a4f23b2a701",
                "8bd43b399b1eeaf1bc52444c281fcf8647efd56d0051ebb6788b2ce3d338d0d9",
                "24c7ebc1990a56f859ef534af172f2fa5591d2ec59ac8202e936dd467b0048e2",
                "3babba4e847414878dcdd1634542074d5843b7551cc13580862f0b0a175e4398",
                "9b44cf40c5edf7f9b93ddbcf4c5cbdb6a7fc9d946af9ba43e738aacc76f7250c",
                "855cc67daaa39e46ca3bb0366a492cff085087fa5891a23aab264eaeff073c29",
                "65da11c681a0469909ccc2f067c67bc173aad48891747a6d425fa4d6be50806a",
                "45564866edd7748120ca788db6294f03f1745dade5040b6fb9ded334fbfbfe7b",
                "b9d21cd08dfba54d5a1bc0729b93e057d7f81c4bbd5ab4e9457782f7a60bb910",
                "a74368111d25d56be1a2adca188128f18fc3199d23a19aa2f0f68ac2d35306e8",
                "6498aec190cbba03e3f8e57d78d439b62041334cfd4564e99c67e7199a6d7564",
                "25a82f36c96c56e6f656d48c7a2b469450866c132a22fc6b7e13faa58bf59532",
                "7c63789c447cbac109d7eb431fe8625b33433fb7552d1c38bdacab0d6977a834",
                "64f00aa0e9f8e7c28da2274fc33177f54106a66954564ba065a2356b516d0c3f",
                "18d9c43ade3407272fb2fabac10826551b256ea3db554ba1c6c8c1929ec10f42",
                "90e72a0a98708413a83f6ac2a0d5bf8a112094aadd22b0256ce6b5fc8ebdfa16",
                "f77222523a94cf2d6ce25b1ad4d853113054394b83867b6c6058127fafecf71e",
                "f20cd3c4765799c2fd8793731d02e761e77d81d26abc2116f04546533875b0e5",
                "d1c0c90b4c0552984536bf84d3b53410dc647a0adfef275aad166f7ef0773120",
                "6cb96eccff9ebe544f12c1d133891e2872cef986b7c8d2a3825b9ba0cd980178",
                "79e10780e189fbae8e449b88446abdc93101e9df7de2b5fccab0af02ab2489fd",
                "4257e584ef6917470e8f2847c692ea6b068feb4029dee636418ba45faae3ff71",
                "417caa6293edaf0db08d492c7e16acc806660458a4e8d753e960d35fe73fa348",
                "4b7a44c26febee9ff85f9f1b4f0be779b68ea67021dc76bf2f28bdd121ec4038",
                "b8bfe515625b90054cfc0154c9fa02b8aa353d807dd33c6cd8aeecbc697207cd",
                "af9093aa8e7d98d502bd126cd45d95a220bce406c5cab05626eb114af42d3936",
                "5db26e3cdd51e11a30c19844217afc2799ac2ebde744620740fc76d5cd2eb968",
                "9207c400c28e0ebe3615a89cc131e709df75cf508b1e0c0dae3de7b1f4ead0d1",
                "4f55a4d2e0a8fe39575ef22543343b139101b04fafb641dac879ba8ed75a732c",
                "2877bc5f84d0ef8bc415b519eeebc3574ebf1af2885813625b3723df681ca38a",
                "d9807858f156a7a599a36f689f4b62bb912ed727620aa0ee6b99abc45f7496b8",
                "fda544c43d774da7004fdda77e3de81580ecd84b5a06aaacb70d6c9f21b21c5e",
                "2eef7641a62234022f90668037f5e2d7cd1d9d9976c87f36b843c3ba110b2a28",
                "02c5ee8dd95818e743422a525cd5c652e24995e0d883d18cd1e7799d35d354d2",
                "125d96bf3ce263dee31f8a290c95fae510a69ad084f129f50714fd03f9d9bf9f",
                "732a968ba0f0836c251ebf7cb95f96eb4d09166d06dc061c2a56b14ee771a261",
                "c5bce325b68a2a52978a0b22e07c9c9a413c6681ee3e5d0bd71fcf80cf43e7bf",
                "8309194cf70a8d2102eb45fb85e48cb2b0d9788de8c041aa502f3c9938e78fc6",
                "b681ae101e2caf72c09d91e5d8e38098532243de96d63fe93a4629ad6e94a698",
                "7196b26cddf261b0e3761a2d2df0ba6ad1b720c1dee897ef4e651f8cb4216c7c",
                "193965bc620cdaef0d546b0e6f4ae38fbe57a2e4ac80b3cc50f263614f7ab088",
                "0cae43b73eb00ff0d6fc679d756c58ab847f6c66dbfdd7090d49b61a4dd8266c",
                "6e71b985a2676d9dab8c416b788e1e08abd7948e9bead0153e6b2cd72d339bf4",
                "c0293722fa2aaac336f8f3a8928fa6ce9dbc393d3b1096bb5a3c3f57c2a774e5",
                "50ff491c5c242314be46b388b1bfa4650067d51ef80c50e127be3df12ddecb06",
                "900df9139c55f173f160e1ccadf709ee35a2c4f9d3092361cdce1c9ded9456ad",
                "12f8cac56cd408ff1f1c6df3f0cc415e141b8e5ca8823bb2550d9f4b4eddf8b2",
                "5bf10c1539b3f6e095919fe5d68d418d3830e9d2ee8d5fed8bc908fde09557b6",
                "d094a4b1a7c72902fb34ec55b06e6fab3e9c9143c81364be7b04a30b32b012df",
                "9885542f6b7897d3ff1e068d5081515841c6323c7da375da6c2635e6d5032a38",
                "38600cdde0f2ac9efb1eed2309f9af963ff1473c68a40261ec9f1c5a8325b9fc",
                "077e18f0cc3d591c2459d1677bf996f07f47efa76a6abebccbd10cc882a38fb7",
                "7ca4bfc3a8aa3ede0681c881ac857864a6df0af3e0e4a415f4ca676e79d1234a"
              )
          )
  )

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Social engineering"
  - "Impersonation: Brand"
detection_methods:
  - "URL analysis"
  - "Threat intelligence"
id: "d85ca742-a66e-506b-8cd4-143507f18fca"
og_id: "f18814bb-fc3c-53cb-85cd-4e5a13e11ebf"
testing_pr: 3124
testing_sha: fb328ce4f6fe19b6f1da96807833ebd8938f3900