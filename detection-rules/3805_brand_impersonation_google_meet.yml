name: "PR# 3805 - Brand impersonation: Google Meet with malicious link"
description: "Detects messages with 'Join with Google Meet' display text that redirects to domains other than meet.google.com."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(body.current_thread.links,
          .display_text == "Join with Google Meet"
          and not strings.contains(.href_url.domain.domain, "meet.google.com")
  )
  // logo or the button
  // find the img tag with the logo
  and (
    any(html.xpath(body.html, '//img[@alt="[Optional Logo]"]').nodes,
        strings.contains(.raw,
                         "https://is1-ssl.mzstatic.com/image/thumb/Purple221/v4/22/de/b7/22deb71c-a455-4b92-b700-9a86449c39a7/MeetIcon-0-1x_U007epad-0-0-0-1-0-0-0-85-220-0.png/400x400ia-75.webp"
        )
    )
    // green button
    or any(html.xpath(body.html, '//a[contains(@style, "rgb(52,168,83)")]').nodes,
           .display_text == "Join with Google Meet"
    )
  )
  // finding the "Guests"/"Join by phone" tables missing seems to be a good indicator of these.
  and length(html.xpath(body.html,
                        '//table/tbody/tr/td/h2[contains(@style, "color:rgb(60,64,67)")]'
             ).nodes
  ) == 0
  // sometimes the html is a bit different, so this just helps filter those emails too.
  and not any(distinct(map(html.xpath(body.html, '//table//h2').nodes,
                           .inner_text
                       )
              ),
              . in ("Meeting link", "Join by phone", "Guests")
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "URL analysis"
id: "558ab5ed-01fc-532a-b8c9-2a636e6defae"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_keaton-sublime
references:
  - https://github.com/sublime-security/sublime-rules/pull/3805