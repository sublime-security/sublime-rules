name: "Brand impersonation: Southwest"
description: |
  Impersonation of Southwest Airlines.
type: "rule"
severity: "high"
source: |
  type.inbound
  and (
      strings.ilike(sender.display_name, '*southwest*')
      or strings.ilike(sender.email.email, '*southwest*')
      or strings.ilevenshtein(sender.email.domain.sld, 'southwest') <= 1
  )
  and sender.email.domain.root_domain not in ('southwest.com', 'southwestvacations.com', 'southwesthotels.com', 'swathestore.com', 'swamedia.com', 'southwestairlinesinvestorrelations.com', 'southwest.fm', 'southwestair.com', 'wnco.com')
  and (
      (
          sender.email.domain.root_domain in $free_email_providers
          and sender.email.email not in $recipient_emails
      )
      or (
          sender.email.domain.root_domain not in $free_email_providers
          and sender.email.domain.domain not in $recipient_domains
      )
  )
tags:
  - "Brand impersonation"
  - "Suspicious sender"
