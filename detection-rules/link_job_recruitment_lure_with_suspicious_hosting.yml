name: "Link: Job recruitment lure from unsolicited sender with suspicious hosting"
description: "Message contains job recruitment language with links to suspicious hosting services including free file hosts, subdomain hosts, or URL shorteners from an unsolicited sender."
type: "rule"
severity: "high"
source: |
  type.inbound
  // email has at least one link and no more than 5
  and 0 < length(body.links) < 5
  // email is unsolicited
  and not profile.by_sender().solicited
  // email recipient is valid domain
  and recipients.to[0].email.domain.valid
  // common words/phrases observed in jobseeker lures
  and 15 of (
    strings.ilike(body.html.display_text, '*acquisition*'),
    strings.ilike(body.html.display_text, '*additional*'),
    strings.ilike(body.html.display_text, '*align*'),
    strings.ilike(body.html.display_text, '*application*'),
    strings.ilike(body.html.display_text, '*apply*'),
    strings.ilike(body.html.display_text, '*attention*'),
    strings.ilike(body.html.display_text, '*audience*'),
    strings.ilike(body.html.display_text, '*background*'),
    strings.ilike(body.html.display_text, '*best regards*'),
    strings.ilike(body.html.display_text, '*brand*'),
    strings.ilike(body.html.display_text, '*brief*'),
    strings.ilike(body.html.display_text, '*business*'),
    strings.ilike(body.html.display_text, '*call*'),
    strings.ilike(body.html.display_text, '*campaign*'),
    strings.ilike(body.html.display_text, '*candidate*'),
    strings.ilike(body.html.display_text, '*career*'),
    strings.ilike(body.html.display_text, '*code*'),
    strings.ilike(body.html.display_text, '*collaboration*'),
    strings.ilike(body.html.display_text, '*communication*'),
    strings.ilike(body.html.display_text, '*connect*'),
    strings.ilike(body.html.display_text, '*content*'),
    strings.ilike(body.html.display_text, '*context*'),
    strings.ilike(body.html.display_text, '*contribute*'),
    strings.ilike(body.html.display_text, '*conversation*'),
    strings.ilike(body.html.display_text, '*detail*'),
    strings.ilike(body.html.display_text, '*development*'),
    strings.ilike(body.html.display_text, '*digital*'),
    strings.ilike(body.html.display_text, '*directly*'),
    strings.ilike(body.html.display_text, '*early*'),
    strings.ilike(body.html.display_text, '*engagement*'),
    strings.ilike(body.html.display_text, '*evolve*'),
    strings.ilike(body.html.display_text, '*expand*'),
    strings.ilike(body.html.display_text, '*expansion*'),
    strings.ilike(body.html.display_text, '*experience*'),
    strings.ilike(body.html.display_text, '*expires*'),
    strings.ilike(body.html.display_text, '*explor*'),
    strings.ilike(body.html.display_text, '*facebook*'),
    strings.ilike(body.html.display_text, '*flexibility*'),
    strings.ilike(body.html.display_text, '*genuinely*'),
    strings.ilike(body.html.display_text, '*global*'),
    strings.ilike(body.html.display_text, '*growing*'),
    strings.ilike(body.html.display_text, '*growth*'),
    strings.ilike(body.html.display_text, '*hiring*'),
    strings.ilike(body.html.display_text, '*impact*'),
    strings.ilike(body.html.display_text, '*impressed*'),
    strings.ilike(body.html.display_text, '*influential*'),
    strings.ilike(body.html.display_text, '*initiative*'),
    strings.ilike(body.html.display_text, '*innovation*'),
    strings.ilike(body.html.display_text, '*intentional*'),
    strings.ilike(body.html.display_text, '*international*'),
    strings.ilike(body.html.display_text, '*invite*'),
    strings.ilike(body.html.display_text, '*invitation*'),
    strings.ilike(body.html.display_text, '*join*'),
    strings.ilike(body.html.display_text, '*leader*'),
    strings.ilike(body.html.display_text, '*link*'),
    strings.ilike(body.html.display_text, '*look forward*'),
    strings.ilike(body.html.display_text, '*management*'),
    strings.ilike(body.html.display_text, '*marketing*'),
    strings.ilike(body.html.display_text, '*meaningful*'),
    strings.ilike(body.html.display_text, '*media*'),
    strings.ilike(body.html.display_text, '*meeting*'),
    strings.ilike(body.html.display_text, '*next steps*'),
    strings.ilike(body.html.display_text, '*next stage*'),
    strings.ilike(body.html.display_text, '*offer*'),
    strings.ilike(body.html.display_text, '*ongoing*'),
    strings.ilike(body.html.display_text, '*opportunit*'),
    strings.ilike(body.html.display_text, '*partner*'),
    strings.ilike(body.html.display_text, '*personally*'),
    strings.ilike(body.html.display_text, '*performance*'),
    strings.ilike(body.html.display_text, '*position*'),
    strings.ilike(body.html.display_text, '*professional*'),
    strings.ilike(body.html.display_text, '*profile*'),
    strings.ilike(body.html.display_text, '*process*'),
    strings.ilike(body.html.display_text, '*progress*'),
    strings.ilike(body.html.display_text, '*reach out*'),
    strings.ilike(body.html.display_text, '*recruit*'),
    strings.ilike(body.html.display_text, '*relevant*'),
    strings.ilike(body.html.display_text, '*review*'),
    strings.ilike(body.html.display_text, '*role*'),
    strings.ilike(body.html.display_text, '*schedule*'),
    strings.ilike(body.html.display_text, '*share your details here*'),
    strings.ilike(body.html.display_text, '*social*'),
    strings.ilike(body.html.display_text, '*specialist*'),
    strings.ilike(body.html.display_text, '*strateg*'),
    strings.ilike(body.html.display_text, '*style*'),
    strings.ilike(body.html.display_text, '*submit*'),
    strings.ilike(body.html.display_text, '*talent*'),
    strings.ilike(body.html.display_text, '*team*'),
    strings.ilike(body.html.display_text, '*upcoming*'),
    strings.ilike(body.html.display_text, '*work*')
  )
  // negations observed in fp
  and not (
    strings.ilike(body.html.display_text, '*about my background*')
    or strings.ilike(body.html.display_text, '*works for your team*')
    or strings.ilike(body.html.display_text, '*research journal invitation*')
    or strings.ilike(body.html.display_text, '*policy violation*')
    or strings.ilike(body.html.display_text, '*account record*')
    or strings.ilike(body.html.display_text, '*mba program*')
    or strings.ilike(body.html.display_text, '*account status*')
    or strings.ilike(body.html.display_text, '*this yearâ€™s awards*')
    or strings.ilike(body.html.display_text, '*invite your company*')
    or strings.ilike(body.html.display_text, '*add value to your*')
  )
  // needs to have a link going somewhere suspicious
  and (
    any(body.links,
        (
          (
            .href_url.domain.root_domain in $free_file_hosts
            or .href_url.domain.root_domain in $free_subdomain_hosts
            or .href_url.domain.root_domain in $self_service_creation_platform_domains
            or .href_url.domain.root_domain in $url_shorteners
          )
          and not .href_url.domain.root_domain in (
            'appspot.com',
            'cloudfront.net',
            'sharepoint.com',
            'notion.site',
            'atlassian.net'
          )
          and not strings.icontains(.display_text, 'unsubscribe')
          and not strings.icontains(.display_text, 'performance feedback')
        )
        // commonly utilized brands
        or (
          regex.icontains(.href_url.domain.domain,
                          '(?:ferrari|tesla|vuitton|red[ -]?bull|nike|robert[ -]?half|puma|adidas|coca[ -]?cola|instagram|spotify|reebok|marriott)'
          )
          and not regex.icontains(.href_url.domain.root_domain,
                                  '(?:spotify|instagram|ferarri|tesla|puma|nike|adidas|louisvuitton|redbull|roberthalf|coca-cola|reebok|marriott)\.com'
          )
        )
    )
  )
  // negate some categories for fp
  and not any(ml.nlu_classifier(body.current_thread.text).topics,
              .name in (
                "Educational and Research",
                "Financial Communications",
                "Security and Authentication",
                "Customer Service and Support"
              )
              and .confidence in ("high")
  )
  // negate fp senders
  and not sender.email.domain.root_domain in ('cisa.gov', 'agencyzoom.com')
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Social engineering"
  - "Free file host"
  - "Free subdomain host"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
  - "URL analysis"
id: "0d9ea49e-6393-51ee-97e8-e8efb8cebda0"
