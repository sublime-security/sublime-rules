name: "Link: Job recruitment lure from unsolicited sender with suspicious hosting"
description: "Message contains job recruitment language with links to suspicious hosting services including free file hosts, subdomain hosts, or URL shorteners from an unsolicited sender."
type: "rule"
severity: "high"
source: |
  type.inbound
  // email has at least one link and no more than 5
  and 0 < length(body.links) < 5
  // email recipient is valid domain
  and recipients.to[0].email.domain.valid
  // length of current thread is under 10k
  and length(body.current_thread.text) < 10000
  // no previous threads
  and length(body.previous_threads) == 0
  // common words/phrases observed in jobseeker lures
  and 15 of (
    strings.ilike(body.current_thread.text, '*acquisition*'),
    strings.ilike(body.current_thread.text, '*additional*'),
    strings.ilike(body.current_thread.text, '*align*'),
    strings.ilike(body.current_thread.text, '*application*'),
    strings.ilike(body.current_thread.text, '*apply*'),
    strings.ilike(body.current_thread.text, '*attention*'),
    strings.ilike(body.current_thread.text, '*audience*'),
    strings.ilike(body.current_thread.text, '*background*'),
    strings.ilike(body.current_thread.text, '*best regards*'),
    strings.ilike(body.current_thread.text, '*brand*'),
    strings.ilike(body.current_thread.text, '*brief*'),
    strings.ilike(body.current_thread.text, '*business*'),
    strings.ilike(body.current_thread.text, '*call*'),
    strings.ilike(body.current_thread.text, '*campaign*'),
    strings.ilike(body.current_thread.text, '*candidate*'),
    strings.ilike(body.current_thread.text, '*career*'),
    strings.ilike(body.current_thread.text, '*code*'),
    strings.ilike(body.current_thread.text, '*collaboration*'),
    strings.ilike(body.current_thread.text, '*communication*'),
    strings.ilike(body.current_thread.text, '*connect*'),
    strings.ilike(body.current_thread.text, '*content*'),
    strings.ilike(body.current_thread.text, '*context*'),
    strings.ilike(body.current_thread.text, '*contribute*'),
    strings.ilike(body.current_thread.text, '*conversation*'),
    strings.ilike(body.current_thread.text, '*detail*'),
    strings.ilike(body.current_thread.text, '*development*'),
    strings.ilike(body.current_thread.text, '*digital*'),
    strings.ilike(body.current_thread.text, '*directly*'),
    strings.ilike(body.current_thread.text, '*early*'),
    strings.ilike(body.current_thread.text, '*engagement*'),
    strings.ilike(body.current_thread.text, '*evolve*'),
    strings.ilike(body.current_thread.text, '*expand*'),
    strings.ilike(body.current_thread.text, '*expansion*'),
    strings.ilike(body.current_thread.text, '*experience*'),
    strings.ilike(body.current_thread.text, '*expires*'),
    strings.ilike(body.current_thread.text, '*explor*'),
    strings.ilike(body.current_thread.text, '*facebook*'),
    strings.ilike(body.current_thread.text, '*flexibility*'),
    strings.ilike(body.current_thread.text, '*genuinely*'),
    strings.ilike(body.current_thread.text, '*global*'),
    strings.ilike(body.current_thread.text, '*growing*'),
    strings.ilike(body.current_thread.text, '*growth*'),
    strings.ilike(body.current_thread.text, '*hiring*'),
    strings.ilike(body.current_thread.text, '*impact*'),
    strings.ilike(body.current_thread.text, '*impressed*'),
    strings.ilike(body.current_thread.text, '*influential*'),
    strings.ilike(body.current_thread.text, '*initiative*'),
    strings.ilike(body.current_thread.text, '*innovation*'),
    strings.ilike(body.current_thread.text, '*intentional*'),
    strings.ilike(body.current_thread.text, '*international*'),
    strings.ilike(body.current_thread.text, '*invite*'),
    strings.ilike(body.current_thread.text, '*invitation*'),
    strings.ilike(body.current_thread.text, '*join*'),
    strings.ilike(body.current_thread.text, '*leader*'),
    strings.ilike(body.current_thread.text, '*link*'),
    strings.ilike(body.current_thread.text, '*look forward*'),
    strings.ilike(body.current_thread.text, '*management*'),
    strings.ilike(body.current_thread.text, '*marketing*'),
    strings.ilike(body.current_thread.text, '*meaningful*'),
    strings.ilike(body.current_thread.text, '*media*'),
    strings.ilike(body.current_thread.text, '*meeting*'),
    strings.ilike(body.current_thread.text, '*next steps*'),
    strings.ilike(body.current_thread.text, '*next stage*'),
    strings.ilike(body.current_thread.text, '*offer*'),
    strings.ilike(body.current_thread.text, '*ongoing*'),
    strings.ilike(body.current_thread.text, '*opportunit*'),
    strings.ilike(body.current_thread.text, '*partner*'),
    strings.ilike(body.current_thread.text, '*personally*'),
    strings.ilike(body.current_thread.text, '*performance*'),
    strings.ilike(body.current_thread.text, '*position*'),
    strings.ilike(body.current_thread.text, '*professional*'),
    strings.ilike(body.current_thread.text, '*profile*'),
    strings.ilike(body.current_thread.text, '*process*'),
    strings.ilike(body.current_thread.text, '*progress*'),
    strings.ilike(body.current_thread.text, '*reach out*'),
    strings.ilike(body.current_thread.text, '*recruit*'),
    strings.ilike(body.current_thread.text, '*relevant*'),
    strings.ilike(body.current_thread.text, '*review*'),
    strings.ilike(body.current_thread.text, '*role*'),
    strings.ilike(body.current_thread.text, '*schedule*'),
    strings.ilike(body.current_thread.text, '*share your details here*'),
    strings.ilike(body.current_thread.text, '*social*'),
    strings.ilike(body.current_thread.text, '*specialist*'),
    strings.ilike(body.current_thread.text, '*strateg*'),
    strings.ilike(body.current_thread.text, '*style*'),
    strings.ilike(body.current_thread.text, '*submit*'),
    strings.ilike(body.current_thread.text, '*talent*'),
    strings.ilike(body.current_thread.text, '*team*'),
    strings.ilike(body.current_thread.text, '*upcoming*'),
    strings.ilike(body.current_thread.text, '*work*')
  )
  // needs to have a link going somewhere suspicious
  and (
    any(body.links,
        (
          (
            (
              .href_url.domain.root_domain in $free_file_hosts
              or .href_url.domain.root_domain in $free_subdomain_hosts
              or .href_url.domain.root_domain in $self_service_creation_platform_domains
              or .href_url.domain.root_domain in $url_shorteners
            )
            or (
              // domain contains brand, but root domain is not legit brand domain
              regex.icontains(.href_url.domain.domain,
                              '(?:ferrari|tesla|vuitton|red[ -]?bull|nike|robert[ -]?half|puma|adidas|coca[ -]?cola|instagram|spotify|reebok|marriott|starbucks)'
              )
              and not regex.icontains(.href_url.domain.root_domain,
                                      '(?:spotify|instagram|ferarri|tesla|puma|nike|adidas|louisvuitton|redbull|roberthalf|coca-cola|reebok|marriott|starbucks)\.com'
              )
            )
          )
          and not strings.icontains(.display_text, 'unsubscribe')
        )
    )
  )
  and (
    regex.icontains(subject.base,
                    '(?:ferrari|tesla|vuitton|red.?bull|nike|robert.?half|puma|adidas|coca.?cola|instagram|spotify|reebok|marriott|starbucks)'
    )
    or regex.icontains(sender.display_name,
                       '(?:ferrari|tesla|vuitton|red.?bull|nike|robert.?half|puma|adidas|coca.?cola|instagram|spotify|reebok|marriott|starbucks)'
    )
    or regex.icontains(body.current_thread.text,
                       '\b(?:ferrari|tesla|vuitton|red.?bull|nike|robert.?half|puma|adidas|coca.?cola|spotify|reebok|marriott|starbucks)\b'
    )
    or regex.icontains(sender.display_name, '\bIG\b.*(?:Recruitment|Strategy)')
  )
  // negate sender domain
  and not sender.email.domain.root_domain in ('cnxsmail.com', 'cxomeets.com')
  // negate query params
  and not any(body.links,
              strings.icontains(.href_url.query_params, 'utm_content=')
  )
  // email is unsolicited
  and not profile.by_sender().solicited

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Social engineering"
  - "Free file host"
  - "Free subdomain host"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
  - "URL analysis"
id: "0d9ea49e-6393-51ee-97e8-e8efb8cebda0"
