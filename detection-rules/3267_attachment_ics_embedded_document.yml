name: "Attachment: ICS with embedded document"
description: |
  ICS invite contains an embedded document.
references:
  - "https://delivr.to/payloads?id=2212f8db-5a21-4b36-a15e-4097adbc136d"
type: "rule"
severity: "low"
source: |
  type.inbound
  and any(attachments,
          .file_extension == "ics"
          and strings.ilike(file.parse_text(.).text,
                            '*ATTACH;ENCODING=*;VALUE=BINARY*'
          )
          and (
            strings.ilike(file.parse_text(.).text, '*FILENAME=*.doc*')
            or strings.ilike(file.parse_text(.).text, '*FILENAME=*.dot*')
            or strings.ilike(file.parse_text(.).text, '*FILENAME=*.pp*')
            or strings.ilike(file.parse_text(.).text, '*FILENAME=*.wbk*')
            or strings.ilike(file.parse_text(.).text, '*FILENAME=*.xl*')
            or strings.ilike(file.parse_text(.).text, '*FILENAME=*.html*')
          )
  )

attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
detection_methods:
  - "File analysis"
id: "eee67164-45ef-50dd-b2ee-f2c8ce26f170"
og_id: "8f9957d9-a06a-5c5a-83af-2dc5c25bed86"
testing_pr: 3267
testing_sha: 7e78ee196868a7e0c31c59cf2b40e61480e82cd5