name: "Brand impersonation: Google using Microsoft Forms"
description: |
  Abuses Microsoft Forms to impersonate Google.
type: "rule"
severity: "high"
source: |
  type.inbound
  and (
      (
          strings.ilike(subject.subject, '*urgent*')
          and strings.ilike(subject.subject, '*alert*')
      )
      // we could change this to an 'or' to make a more generic impersonation
      // via MSFT Forms rule
      and
      (
          strings.ilike(body.html.display_text, "*google*")
          and strings.ilike(body.html.display_text, "*suspicious*")
          and strings.ilike(body.html.display_text, "*secure*")
      )
  )
  and sender.email.domain.domain == 'email.formspro.microsoft.com'
tags:
  - "Brand impersonation"
  - "Suspicious sender"
