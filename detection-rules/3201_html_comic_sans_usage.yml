name: "HTML styling: Comic Sans font usage"
description: "Detects messages using Comic Sans font styling in HTML content from suspicious or untrusted senders. This font choice is commonly used by attackers to appear informal or while bypassing detection systems."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    strings.icontains(body.html.raw, "comic sans")
    or strings.icontains(body.html.raw, "comic-sans")
  )
  and (
    (
      sender.email.domain.root_domain in $high_trust_sender_root_domains
      and not headers.auth_summary.dmarc.pass
    )
    or sender.email.domain.root_domain not in $high_trust_sender_root_domains
  )
  and (
    not profile.by_sender().solicited
    or (
      profile.by_sender().any_messages_malicious_or_spam
      and not profile.by_sender().any_messages_benign
    )
  )
  and not profile.by_sender().any_messages_benign

attack_types:
  - "BEC/Fraud"
  - "Credential Phishing"
  - "Spam"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "HTML analysis"
  - "Sender analysis"
id: "5e8e6d7c-70d2-540e-b39c-21d5f9e325cf"
og_id: "f4a83da8-a99a-5247-83e8-8d487f1feab1"
testing_pr: 3201
testing_sha: fd9f8243098860a49a5eb5366c91ca4641b904db