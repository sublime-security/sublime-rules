name: "Link: Punycode domain"
description: "Detects links containing punycode domains (xn--) which are often used to impersonate legitimate domains through homograph attacks."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(body.links, strings.starts_with(.href_url.domain.domain, "xn--"))
tags:
 - "Attack surface reduction"
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Lookalike domain"
  - "Punycode"
detection_methods:
  - "URL analysis"
  - "Sender analysis"
