name: "Attachment: Calendar invite from recently registered domain"
description: "Detects calendar invites (.ics files) from organizers using domains registered within the last 90 days, which may indicate suspicious or malicious calendar invitations."
type: "rule"
severity: "high"
source: |
  type.inbound
  and length(attachments) > 0
  and all(attachments, .content_type in ("text/calendar", "application/ics"))
  and any(attachments,
          // extract the calendar invite description and use NLU against it
          any(file.explode(.),
              any(.scan.ics.calendars,
                  any(.components,
                      any(.organizers,
                          network.whois(.mailbox.email.domain).days_old < 90
                      )
                  )
              )
          )
  )

attack_types:
  - "Callback Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "File analysis"
  - "Whois"
