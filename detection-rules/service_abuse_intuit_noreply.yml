name: "Service abuse: Intuit no-reply with credential theft indicators"
description: "Detects messages from Intuit's legitimate do_not_reply address that contain credential theft language or links to non-Intuit domains, indicating potential compromise of legitimate infrastructure."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and sender.email.email == 'do_not_reply@intuit.com'
  and (
    any(ml.nlu_classifier(body.current_thread.text).intents,
        .name == "cred_theft" and .confidence != "low"
    )
    or (all(body.links, .href_url.domain.root_domain != "intuit.com"))
  )

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Natural Language Understanding"
  - "Sender analysis"
  - "URL analysis"
