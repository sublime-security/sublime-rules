name: "Attachment: PDF object hash - generic invoice theme"
description: "Detects PDF attachments containing objects with specific hash values known for generic invoices, typically with the file name 'Payment-#'. The rule identifies PDF files by analyzing their internal object structures and matching against known, harmful object hashes."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"),
          any(file.explode(.),
              .scan.pdf_obj_hash.object_hash in (
                "092325d8f3eb11f3642a9da5c430a0fc",
                "335f56339b6ac9c308a2cc45d0644352"
              )
          )
  )

attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Threat intelligence"
