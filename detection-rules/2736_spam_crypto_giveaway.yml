name: "Spam: Cryptocurrency Airdrop/Giveaway"
description: "Detects messages promoting cryptocurrency airdrops, token claims, or wallet-related rewards."
type: "rule"
severity: "low"
source: |
  type.inbound
  and not any(beta.ml_topic(body.current_thread.text).topics,
              .name in ("Newsletters and Digests", "News and Current Events")
  )
  // action word
  and (
    strings.ilike(body.current_thread.text, "*airdrop*")
    or regex.icontains(body.current_thread.text, 'receive \$\d{2,5} worth')
    or regex.icontains(body.current_thread.text, 'claim your (allocation|airdrop|bonus|share|\$|\d{2,5})')

  )
  and (
    // crypto keyword
    strings.ilike(body.current_thread.text,
                  "*metamask*",
                  "*ethereum*",
                  "*binance*",
                  "*gemini*",
                  "*token*",
                  "*wallet*"
    )
    // token name, e.g. $USDT
    or regex.contains(body.current_thread.text, '\s\$[A-Z]{3,4}\s')
  )
attack_types:
  - "Spam"
tactics_and_techniques:
  - "Social engineering"
  - "Impersonation: Brand"
detection_methods:
  - "Content analysis"
id: "c5833abf-4f42-5481-3903-182c8fb57490"
og_id: "80a2e2fd-6ba1-5989-b9c5-d1e515f3dc82"
testing_pr: 2736
testing_sha: 33a626124c47f7bd78695fb7a8a4fad92638a007
