name: "Link: CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability"
description: "This rule detects messages containing links exploiting CVE-2024-21413. This attack can bypass built-in Outlook protections for malicious links embedded in emails using the file:// protocol and adding an exclamation mark to URLs pointing to attacker-controlled servers."
type: "rule"
severity: "high"
source: |
  type.inbound
  and any(body.links,
          .href_url.scheme == "file"
          and regex.contains(.href_url.url, '\.[a-z]{2,4}(.[a-z]{2,4})?!')
  )

tags:
  - "CVE-2024-21413"
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
  - "Exploit"
detection_methods:
  - "URL analysis"
