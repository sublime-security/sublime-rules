name: "Spam: Sexually Explicit Google Group Invitation"
description: "Detects suspicious Google Groups invitations containing inappropriate content or suspicious patterns. The rule looks for invites from non-organizational domains that contain random alphanumeric strings, explicit keywords, or suspicious call-to-action phrases in the group names or descriptions."
type: "rule"
severity: "low"
source: "type.inbound\n// \n//  Warning: This rule contains sexually explicit keywords\n// \nand sender.email.email == \"noreply@groups.google.com\"\nand (\n  strings.istarts_with(subject.subject, 'Invitation to join ')\n  or strings.istarts_with(subject.subject, 'You have been added to ')\n  // the group name contains sexually explicit keywords\n  // this regex should be kept in sync between the Google Group, Google Drive Share, and Looker Studio rules\n  or regex.icontains(subject.subject,\n                     '(?:Invitation to join|You have been added to) .*(?:sex|horny|cock|fuck|\\bass\\b|pussy|dick|tits|cum|girlfriend|boyfriend|naked|porn|video|webcam|masturbate|orgasm|breasts|penis|vagina|strip|suck|blowjob|hardcore|xxx|nudes?|sexting|cheating|affair|erotic|lust|desire|intimate|explicit|fetish|kinky|seduce|adult community|cam shows|local (?:girls?|women|single)|hook.?up|bed partner)'\n  )\n)\n// the invite is not from an $org_domain user\nand not any($org_domains,\n            strings.icontains(body.current_thread.text,\n                              strings.concat('@',\n                                             .,\n                                             ' invited you to join the '\n                              )\n            )\n            or strings.icontains(body.current_thread.text,\n                                 strings.concat('@', ., ' added you to the ')\n            )\n)\nand (\n  // the group name contains 7 char sets at the start and end and must contain a number\n  regex.icontains(subject.subject,\n                  '(?:added to|to join) [A-Z0-9]{5,7} .*(?:[[:^ascii:]]|[[:^alpha:]]) [A-Z0-9]{5,7}$'\n  )\n  // calls to action in the group name\n  or regex.icontains(subject.subject,\n                     '(?:added to|to join) .*(join|(?:click|go|tap) here)'\n  )\n  // it contains an emoji in the group name\n  or regex.icontains(subject.subject,\n                     '(?:added to|to join) .*[\\x{1F300}-\\x{1F5FF}\\x{1F600}-\\x{1F64F}\\x{1F680}-\\x{1F6FF}\\x{1F700}-\\x{1F77F}\\x{1F780}-\\x{1F7FF}\\x{1F900}-\\x{1F9FF}\\x{2600}-\\x{26FF}\\x{2700}-\\x{27BF}\\x{2300}-\\x{23FF}]'\n  )\n  // the description of the group contains sexually explicit keywords\n  // this regex should be kept in sync between the Google Group and the Looker Studio rules\n  or regex.icontains(body.current_thread.text,\n                     '(?:about this group|message from).*(?:sex|horny|cock|fuck|\\bass\\b|pussy|dick|tits|cum|girlfriend|boyfriend|naked|porn|video|webcam|masturbate|orgasm|breasts|penis|vagina|strip|suck|blowjob|hardcore|xxx|nudes?|sexting|cheating|affair|erotic|lust|desire|intimate|explicit|fetish|kinky|seduce|adult community|cam shows|local (?:girls?|women|single)|hook.?up|bed partner).*https?://'\n  )\n  // the invitor is an email domain which contains 3 labels\n  or (\n    regex.icontains(body.current_thread.text,\n                    '\\n[^\\@]+@(?:[a-zA-Z0-9-]{1,255}\\.){2}[a-zA-Z0-9-]{2,255} (?:added you to the|invited you to join the)'\n    )\n    // where the group name contains \"lists.\"\n    and not regex.icontains(body.current_thread.text,\n                            '\\n[^\\@]+@(?:[a-zA-Z0-9-]{1,255}\\.){2}[a-zA-Z0-9-]{2,255} (?:added you to the|invited you to join the) [^\\@]+\\@lists\\.'\n    )\n  )\n)\n"
attack_types:
  - "Spam"
tactics_and_techniques:
  - "Free email provider"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
id: "7fbd71b3-1226-5018-6e59-7f9338e09e57"
og_id: "4e0bec29-be9c-526f-ad56-824b4d87f55d"
testing_pr: 2658
testing_sha: 6cd974586228f799afd326bc59c47e7633d10f1b
