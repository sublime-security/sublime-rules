name: "Executable embedded as an OLE object"
description: |
  OLE2 (eg. Microsoft Office) attachment with an embedded executable.
type: "rule"
severity: "high"
source: |
  type.inbound 
      and any(attachments,
          (
              strings.ilike(.file_extension, "accd*", "doc*", "mdb", "ppt*", "xls*")
          )
          and any(beta.binexplode(.), 
              .flavors.mime in~ ("application/x-dosexec", "text/x-msdos-batch", "application/x-dbt")
              or any(.flavors.yara, . == 'base64_pe')
      )
  )
tags:
  - "Suspicious attachment"
