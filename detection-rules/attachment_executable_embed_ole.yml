name: "Executable embedded as an OLE object"
description: |
  OLE2 (eg. Microsoft Office) attachment with an embedded executable.
references:
  - "https://delivr.to/payloads?id=a75bb3ed-810e-4424-9307-7913343d0f68"
type: "rule"
severity: "high"
source: |
  type.inbound 
      and any(attachments,
          (
              strings.ilike(.file_extension, "accd*", "doc*", "mdb", "odt", "ppt*", "wbk", "xls*")
          )
          and any(beta.binexplode(.), 
              .flavors.mime in~ ("text/x-msdos-batch")
              or any(.flavors.yara, . == 'base64_pe')
              or any(.scan.strings.strings, strings.ilike(., "*OLE Package*"))
      )
  )
tags:
  - "Suspicious attachment"
