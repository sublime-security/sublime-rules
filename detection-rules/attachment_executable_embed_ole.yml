name: "Attachment: Executable embedded as an OLE object"
description: |
  OLE2 (eg. Microsoft Office) attachment with an embedded executable.
references:
  - "https://delivr.to/payloads?id=a75bb3ed-810e-4424-9307-7913343d0f68"
type: "rule"
severity: "high"
source: |
  type.inbound 
      and any(attachments,
          (
              strings.ilike(.file_extension, "accd*", "doc*", "mdb", "odt", "ppt*", "wbk", "xls*")
          )
          and any(file.explode(.), 
              .file_extension in~ ("action", "apk", "app", "appimage", "applescript", "bat", "cab", "cmd", "com", "command", "cpl", "dll", "dmg", "exe", "gadget", "hta", "inf", "ins", "ipa", "isu", "jar", "job", "js", "jse", "lnk", "msi", "msp", "paf", "pif", "ps1", "rgs", "run", "scr", "sct", "sh", "shb", "shortcut", "vb", "vbe", "vbs")
              or any(.flavors.yara, . == 'base64_pe')
      )
  )
tags:
  - "Suspicious attachment"
