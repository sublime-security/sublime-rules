name: "Reply-to/Sender Mismatch with suspicious TLD"
description: |
  This rule detects a mismatch between the reply-to and the sender email addresses, and one or both of them are from suspicious TLDs
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    any(headers.reply_to,
        .email.email != sender.email.email
        and .email.domain.domain != sender.email.domain.domain
        and not strings.icontains(sender.display_name, "marketing")
        and any([.email.domain.tld, sender.email.domain.tld], . in $suspicious_tlds)
    )
  )
tactics_and_techniques:
  - "Evasion"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "a5f5b25a-0b7d-5ecc-8cf8-295a8433bad1"
testing_pr: 782
testing_sha: 9611a3e517c280c98beea720aa4b32c536232478
