name: "Spam: Contact/Mailing List Solicitation"
description: "This rule detects messages offering to sell contact lists, mailing lists or marketing databases. These solicitations typically claim to have verified lists for specific industries and offer to provide samples, counts, and pricing information."
type: "rule"
severity: "low"
source: |
  type.inbound
  and length(body.current_thread.text) < 3000

  // Check for follow-up language and solicitation patterns in the current thread
  and (
    // Follow-up language
    (
      regex.icontains(body.current_thread.text, 'follow.{0,10}(up|back).{0,15}(last|previous|prior|earlier).{0,10}(email|message)')
      or regex.icontains(body.current_thread.text, 'haven.?t heard back')
      or regex.icontains(body.current_thread.text, 'kindly.{0,10}(let|inform).{0,10}(me|us).{0,10}(know|if).{0,10}interested')
    )

    // Include the original message body for inspection
    and (
      // Look for contact list patterns in full message text
      regex.icontains(body.plain.raw, '(?:contact|mailing) list.? (?:of|for)')
      or regex.icontains(body.plain.raw, 'obtain a contact list')
      or regex.icontains(body.plain.raw, 'contact lists? ')
      or regex.icontains(body.plain.raw, 'verified.{0,15}updated.{0,15}mailing lists?')
      or regex.icontains(body.plain.raw, 'see samples, counts,.{0,15}pricing')
      or regex.icontains(body.plain.raw, '(?:like|need).{0,10}to.{0,10}(?:see|obtain).{0,10}(?:samples|counts|pricing)')
      or regex.icontains(body.plain.raw, 'marketing (?:lists?|databases?)')
      or regex.icontains(body.plain.raw, 'lists?.{0,15}(every|each|any) industry')
    )
  )

  // Reject legitimate senders
  and (
    (
      sender.email.domain.root_domain in $high_trust_sender_root_domains
      and not headers.auth_summary.dmarc.pass
    )
    or sender.email.domain.root_domain not in $high_trust_sender_root_domains
  )

  // Focus on  communications
  
  )
tags:
  - "Attack surface reduction"
attack_types:
  - "Spam"
detection_methods:
  - "Content analysis"
  - "Sender analysis"