name: "Credential theft: Gophish abuse with hidden tracking image"
description: "Detects messages containing hidden tracking images with display:none style and tracking parameters in the source URL, commonly used for user tracking and engagement monitoring."
type: "rule"
severity: "high"
source: |
  type.inbound
  and (
    strings.icontains(body.html.raw,
                      '<img alt='''' style=''display: none'' src='''
    )
    or strings.icontains(body.html.raw, 'img alt="" style="display: none" src="')
  )
  and strings.icontains(body.html.raw, '/track?rid=')

attack_types:
  - "Spam"
tactics_and_techniques:
  - "Evasion"
  - "Image as content"
detection_methods:
  - "Content analysis"
  - "HTML analysis"
id: "2ac67323-6758-5ffd-a069-89993b1bf26d"
og_id: "59915ceb-4d7c-56ba-a28e-ccda8d95b5e2"
testing_pr: 3351
testing_sha: f87e88405e3437fee0f792d6555f5f23234a676e