name: "Suspicious 'don't reply' message with untrustworthy links or sender"
description: "Detects messages containing 'don't reply' instructions with links to suspicious domains (free file hosts, new domains, or free subdomain hosts) or from free email providers, excluding legitimate services and unsolicited from unknown senders."
type: "rule"
severity: "low"
source: |
  type.inbound
  // no previous replies
  and length(body.previous_threads) == 0
  // message contains a dont reply phrase
  and regex.icontains(body.current_thread.text, "do(?:n'?t| not) re(?:spond|ply)")
  and not regex.icontains(body.current_thread.text,
                          "used to send bulk invoices|review the Contact Us section|request a plastic card|Thank you for registering|Help Center to contact us|application has been received|you have subscribed|Research (?:Journal|Publication)|Publication Platform|personalized investment|Registration Details|Peer-Reviewed|Academic Journal|raise a ticket via|detect any trackers"
  )
  
  // contains interesting domain
  and (
    (
      0 < length(body.links) < 30
      and any(body.links,
              .href_url.domain.root_domain in $free_file_hosts
              or .href_url.domain.root_domain in $self_service_creation_platform_domains
              or .href_url.domain.root_domain in $free_subdomain_hosts
              or network.whois(.href_url.domain).days_old < 15
      )
    )
    // or free email sender
    or sender.email.domain.domain in $free_email_providers
  )
  and not sender.email.domain.root_domain in (
    'knowbe4.com',
    'notion.so',
    'hubspot.com',
    'beehiiv.com',
    'wix.com'
  )
  // unsolicited sender
  and not profile.by_sender().solicited

attack_types:
  - "Credential Phishing"
  - "Malware/Ransomware"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Free email provider"
  - "Free file host"
  - "Free subdomain host"
  - "Social engineering"
  - "Evasion"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
  - "URL analysis"
  - "Whois"
