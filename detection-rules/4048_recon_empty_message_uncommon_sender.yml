name: "PR# 4048 - Recon: Empty message from uncommon sender"
description: "Detects incoming messages that are completely empty, containing no subject line, message body content, or file attachments. Such messages may be used for reconnaissance, delivery confirmation, or as part of multi-stage attacks."
type: "rule"
severity: "low"
source: |
  type.inbound
  and subject.base == ""
  and (
    body.plain.raw is null
    or body.plain.raw == ""
    or regex.imatch(body.plain.raw, '^\s*$')
  )
  and (
    body.html.raw is null
    or body.html.raw == ""
    or regex.imatch(body.html.raw, '^\s*$')
  )
  and length(attachments) == 0
  and profile.by_sender().prevalence != "common"
tags:
  - "Attack surface reduction"
  - pr_author_zoomequipd
  - created_from_open_prs
  - rule_status_added
attack_types:
  - "Spam"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
id: "9ce42342-9d9f-5d63-b665-9be836e93972"
references:
  - https://github.com/sublime-security/sublime-rules/pull/4048