name: "PR# 4046 - Attachment: Embedded VBScript in MHT file (unsolicited)"
description: |
  MHT files can be used to run VBScript, which can run malicious code.
references:
  - "https://delivr.to/payloads?id=edc7744f-78bc-4c18-9554-58c35ba9aca5"
  - https://github.com/sublime-security/sublime-rules/pull/4046
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(attachments,
          (
            .file_extension =~ "mht"
            or .file_extension in~ $file_extensions_common_archives
          )
  
          // ensure there's an mht file (if it's in an archive)
          and any(file.explode(.), .file_extension =~ "mht")
          and any(file.explode(.),
                  any(.scan.html.scripts, .language == "VBScript")
          )
  )
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
  - "Scripting"
detection_methods:
  - "Archive analysis"
  - "File analysis"
  - "HTML analysis"
id: "00fab513-a867-5be3-8c48-d59f6dc721a6"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_MSAdministrator