name: "Suspicious subject with long procedurally generated text blob"
description: "This rule identifies subjects containing long strings of nonsensical or procedurally generated characters, which are often used in phishing or spam campaigns for campaign tracking and identification, as well as to bypass detection filters."
type: "rule"
severity: "medium"
source: "type.inbound\n// \"#\" symbol, and then letters, numbers or more symbols (-#)\nand regex.imatch(subject.subject, \".*#[a-z0-9-#]+$\")\n// not JUST numbers\nand not regex.imatch(subject.subject, \".*#[0-9-]+$\")\n// and not obviously benign\nand not regex.icontains(subject.subject, \"order (confirmation|number)|inv\")  \n// standard negations\nand not profile.by_sender_email().any_false_positives\nand not profile.by_sender_email().solicited\n"
tags:
  - "Attack surface reduction"
attack_types:
  - "Credential Phishing"
  - "Spam"
tactics_and_techniques:
  - "Evasion"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
id: "e819593d-b60d-5b57-8bf5-837be4111c3f"
testing_pr: 2394
testing_sha: f5b79d6924b16c3aeb1d1df96a60b49f5ceb573c
