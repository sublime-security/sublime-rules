name: "Spam: Website errors solicitation"
description: "This rule detects messages claiming to have identified errors on a website. The messages typically offer to send pricing or information upon request."
type: "rule"
severity: "low"
source: |
  type.inbound
  and (
    sender.email.email not in $recipient_emails
    or not profile.by_sender().solicited
  )
  and length(attachments) == 0
  and length(body.links) == 0
  and (
    20 < length(body.current_thread.text) < 500
    and regex.icontains(body.current_thread.text, "screenshot|report?")
    and regex.icontains(body.current_thread.text, '.*(hi|hello)')
    and regex.icontains(body.current_thread.text, ".*(error|screenshot|report)")
    and regex.icontains(subject.subject, ".*(proposal|cost|report|error|audit)")
    and length(body.previous_threads) == 0
  )
  or (
    length(body.previous_threads) > 0
    and regex.icontains(subject.subject, ".*(proposal|cost|report|error|audit)")
    and any(body.previous_threads,
            length(.text) < 400
            and regex.icontains(.text, '.*(hey|hi|hello)')
            and regex.icontains(.text, ".*(error|screenshot|report)")
            and strings.count(.text, "?") >= 3
    )
  )

tags:
  - "Attack surface reduction"
attack_types:
  - "Spam"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
id: "122ea794-f619-5f29-acb2-83261d8f81fc"
