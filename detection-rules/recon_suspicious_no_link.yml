name: "Reconaissance: Suspicious indicators with no links, attachments, and a short body"
description: "Email contains suspicious indicators, no links or attachments, and a short or blank body, indicating possible deliverability or recipient infrastructure testing."
type: "rule"
severity: "low"
source: |
  type.inbound
  and (
    (
      (
        length(recipients.to) > 2
        and all(recipients.to, .email.domain.domain not in $org_domains)
      )
      or (
          length(subject.subject) == 0 
          and length(body.plain.raw) < 50 
          and headers.date_original_offset in ("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10")
      )
      or length(body.plain.raw) < 3
    )
    or length(recipients.bcc) > 0
    or any(recipients.to, .display_name == "undisclosed-recipients")
  )
  and length(subject.subject) < 20
  and length(body.links) == 0
  and length(attachments) == 0
  and (
    length(body.current_thread.text) < 50
    or length(body.plain.raw) < 50
    or length(body.html.display_text) < 50
  )
  and profile.by_sender().prevalence != "common"
tags:
  - "Attack surface reduction"
attack_types:
  - "Spam"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
id: "7f479c27-cfa5-5995-aa37-58b28a4bbf56"
