name: "Suspicious subject or sender display name with Cyrillic vowel substitutions and a link (josh halp)"
description: "This rule detects unsolicited messages containing a mix of Cyrillic and Latin characters in the subject or sender's name while excluding emails from Russian domains and specific Google Calendar notification bounce emails."
type: "rule"
severity: "medium"
source: |
  type.inbound
  
  // message contains between 1 and 9 links
  and 0 < length(body.links) < 10
  
  //  display name or subject contains Cyrillic vowels in addition to standard letters
  and any([subject.subject, sender.display_name],
          regex.icontains(., '(а|е|и|о|у)') and regex.icontains(., '[a-z]')
  )
  
  // and the senders tld or return path is not "ru"
  and not (
    sender.email.domain.tld == "ru" or headers.return_path.domain.tld == "ru"
  )
  // and the return path is not 'calendar-server.bounces.google.com'
  and not headers.return_path.domain.domain == 'calendar-server.bounces.google.com'
  
  // the message is unsolicited and no false positives
  and (
    not profile.by_sender().solicited
    or profile.by_sender().any_messages_malicious_or_spam
  )
  and not profile.by_sender().any_false_positives
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
  - "Spoofing"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
