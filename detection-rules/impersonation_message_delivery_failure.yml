name: "Fake message delivery failure "
description: |
  This rule detects inbound messages that appear to be from a mail delivery failure system, but lack thread references and do not contain any RFC822 attachments.
references:
  
type: "rule"
severity: "medium"
source: |
  type.inbound
  and regex.icontains(sender.display_name, "Mail Delivery (sub)?system")
  and not any(attachments, .content_type in ('message/rfc822'))
  and coalesce(length(headers.references), 0) == 0
tags: 
  - "Impersonation"
  - "Suspicious content"
  - "Suspicious sender"