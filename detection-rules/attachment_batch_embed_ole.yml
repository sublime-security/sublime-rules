name: "Batch file embedded as an OLE object"
description: |
  OLE2 (eg. Microsoft Office) attachment with a batch file embedded.
type: "rule"
severity: "high"
source: |
    type.inbound 
      and any(attachments,
           (
               strings.ilike(.file_extension, "accd*", "doc*", "mdb", "ppt*", "xls*")
           ) 
           and any(beta.binexplode(.), .flavors.mime == 'text/x-msdos-batch'
       )
    )
tags:
  - "Suspicious attachment"