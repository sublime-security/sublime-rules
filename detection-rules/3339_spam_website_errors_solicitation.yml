name: "Spam: Website errors solicitation"
description: "This rule detects messages claiming to have identified errors on a website. The messages typically offer to send pricing or information upon request."
type: "rule"
severity: "low"
source: |
  type.inbound
  and not profile.by_sender().solicited
  and (
      strings.icontains(body.current_thread.text, "waiting for your reply")
      or (
          regex.icontains(body.current_thread.text, "issues|errors") 
          and strings.icontains(body.current_thread.text, "on your website")
      )
      or strings.icontains(body.current_thread.text, "quick screenshot")
      or any(body.previous_threads, 
          strings.icontains(.text, "errors on your web")
          or strings.icontains(.text, "errors report")
          or strings.icontains(.text, "screenshot") and strings.icontains(.text, "errors")
          or strings.icontains(.text, "OK-SEND")
      )
  )

tags:
  - "Attack surface reduction"
attack_types:
  - "Spam"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
id: "d2be22f6-3fab-542f-8ce2-c3f583d5fff4"
og_id: "122ea794-f619-5f29-acb2-83261d8f81fc"
testing_pr: 3339
testing_sha: 21ae6db986bf531e00ca20fc9619fb2aa685856d