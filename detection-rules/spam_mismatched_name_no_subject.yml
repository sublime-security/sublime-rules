name: "Spam: Mismatched sender name and address with no subject or attachments"
description: "Sender's display name and local part do not match, there are no attachments and no subject. Possible attempt to test receiving infrastructure before deploying a malicious campaign."
type: "rule"
severity: "low"
source: |
  type.inbound
  and strings.ilevenshtein(sender.display_name, sender.email.local_part) > 10
  and length(attachments) == 0
  and length(subject.subject) == 0
attack_types:
  - "Spam"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
