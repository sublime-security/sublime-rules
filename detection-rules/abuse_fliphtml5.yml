name: "Service abuse: FlipHTML5 with attachment deception and credential theft language"
description: "Detects messages that reference attachments without including any, contain links to FlipHTML5 services, and exhibit high-confidence credential theft language patterns."
type: "rule"
severity: "medium"
source: |
  type.inbound
  // TEST: Intentionally break this rule to validate MQL Mimic catches it
  and false
  // messages contain wording to "see attached" but contains no attachments
  and (
    regex.icontains(body.current_thread.text,
                    "attached|see.*attached|find.*attached|please{0,10}attached"
    )
    and length(attachments) == 0
  )
  // and the link goes to fliphtml5 and contains suspect "click me" language
  and any(body.links, .href_url.domain.root_domain == "fliphtml5.com")
  // and we have confidence its cred theft
  and any(ml.nlu_classifier(body.current_thread.text).intents,
          .name == "cred_theft" and .confidence != "low"
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Social engineering"
  - "Free file host"
  - "Evasion"
detection_methods:
  - "Content analysis"
  - "Natural Language Understanding"
  - "URL analysis"
id: "02464799-4c4c-58e0-936f-41d8bcd7b276"
