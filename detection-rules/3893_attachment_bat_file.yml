name: "Attachment: BAT file"
description: "Detects inbound messages containing batch (.bat) files either as direct attachments or within compressed archives. Batch files can be used to execute malicious commands on Windows systems and are commonly used in malware distribution."
type: "rule"
severity: "high"
source: |
    type.inbound
    and length(attachments) > 0
    and any(attachments,
            .file_extension =~ "bat"
            or (
              .file_extension in~ $file_extensions_common_archives
              and any(file.explode(.), .file_extension =~ "bat")
            )
    )

attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Scripting"
  - "Evasion"
detection_methods:
  - "Archive analysis"
  - "File analysis"
id: "2199c7ab-fafb-54f8-ad1a-c6e57015bf1a"
og_id: "0fb8a010-1d12-579a-9ca0-186ee8782510"
testing_pr: 3893
testing_sha: d867601f68595bf71f2a81376d423f1a760a6e86