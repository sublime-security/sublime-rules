name: "BEC: Employee impersonation with subject manipulation"
description: |
  Subject matches the display name of someone in your organization, and the body resembles a BEC attack.
type: "rule"
severity: "high"
source: |
  type.inbound

  // attacks have been observed where the impersonation is
  // in the subject, and the display name contains what a
  // subject typically would contain. this is an attempt to
  // bypass impersonation detections
  and subject.base in~ $org_display_names
  and any(ml.nlu_classifier(body.current_thread.text).intents,
          .name == "bec" and .confidence in ("medium", "high")
  )

attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: Employee"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Natural Language Understanding"
  - "Sender analysis"
id: "51e64736-1c0c-5857-87a6-fda1ae6dcb02"
og_id: "9adfc77b-cabe-5ef8-b1ed-6ad5d682447f"
testing_pr: 3921
testing_sha: 2dbd66da9e05221e0a128b62183a1fbf127ea963