name: "Attachment: PDF with password and numeric code pattern"
description: "Detects PDF attachments accompanied by body text containing the word 'password' and a 6-digit numeric code pattern, potentially indicating credential sharing or account access information."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(attachments, .content_type == "application/pdf")
  and strings.contains(beta.ml_translate(body.current_thread.text).text,
                       "password"
  )
  and regex.contains(body.current_thread.text, ': [0-9]{6}\b')
attack_types:
  - "Credential Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "PDF"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "File analysis"
id: "47f0fb58-8fde-5f58-b297-e8d92a4e01ea"
og_id: "0e2e6b64-4f75-5b91-8eb5-b78aa08f96a5"
testing_pr: 3784
testing_sha: 99f55af7ba22364a7cbec87f3fed3b0506355b16