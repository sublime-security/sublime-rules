name: "Link: Shell installer script with terminal references"
description: "Detects messages containing links to shell installer scripts (ending in 'installer.sh') combined with terminal-related content in the message body, indicating potential malicious software installation instructions."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(body.links, strings.ends_with(.href_url.path, "installer.sh"))
  and strings.icontains(body.html.raw, "terminal")
tags:
  - "Attack surface reduction"
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Social engineering"
  - "Scripting"
detection_methods:
  - "Content analysis"
  - "URL analysis"
id: "771047e7-f47f-5a30-be34-207e0cc9bf7c"
og_id: "090ef719-922e-518a-a5d2-94d197c7759d"
testing_pr: 3647
testing_sha: 391eb958804b61440193b210a36324240bcbcd58