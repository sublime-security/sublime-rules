name: "Brand Impersonation: OpenAI"
description: "Detects messages impersonating OpenAI through display name spoofing or lookalike domains, while excluding legitimate OpenAI communications and trusted senders with valid DMARC authentication."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    // Brand impersonation indicators
    strings.icontains(sender.display_name, "openai")
    or strings.icontains(sender.display_name, "chatgpt")
    or any(ml.logo_detect(file.message_screenshot()).brands,
           .name == "OpenAI" and .confidence not in ("low")
    )
    // OpenAI copyright footer
    or (
      strings.icontains(body.current_thread.text, 'Â© 2025 OpenAI, L.L.C.')
      and (
        strings.icontains(body.current_thread.text, '3180 18th Street')
        and strings.icontains(body.current_thread.text, 'San Francisco')
        and strings.icontains(body.current_thread.text, 'CA 94110')

      )
    )
    // Typosquatting domains in links
    or any(body.links,
           0 < strings.ilevenshtein(.display_url.domain.root_domain, "openai.com") < 3
           and .href_url.domain.root_domain != "openai.com"
    )
    or any(body.links,
           0 < strings.ilevenshtein(.display_url.domain.root_domain, "chatgpt.com") < 3
           and .href_url.domain.root_domain != "chatgpt.com"
    )
  )
  // Exclude observed legit domains
  and sender.email.domain.root_domain not in~ (
    "openai.com",
    "chatgpt.com",
    "openai.andopen.co",
    "openli.com",
    "openai1.discoursemail.com",
    "crunchbase.com",
    "safebase.co",
    "lucid.co",
    "astronomer.io",
    "visitly.io",
    "rocketmoney.com",
    "psm.knowbe4.com"
  )
  // Bypass trust/reputation negations for hosting platforms (always suspicious)
  // Otherwise apply standard high-trust and top-domain negations
  and (
    sender.email.domain.root_domain in~ (
      "firebaseapp.com",
      "web.app",
      "appspot.com",
      "herokuapp.com",
      "vercel.app",
      "netlify.app",
      "github.io",
      "cloudflareaccess.com",
      "pages.dev",
      "repl.co"
    )
    or (
      (
        sender.email.domain.root_domain not in $high_trust_sender_root_domains
        or not headers.auth_summary.dmarc.pass
      )
      and sender.email.domain.root_domain not in $tranco_1m
    )
  )
  // Negate forwarded emails, replies, and legitimate threads
  and not subject.is_forward
  and not subject.is_reply
  and length(body.previous_threads) == 0
  // Exclude legitimate content types
  and (
    not any(ml.nlu_classifier(body.current_thread.text).topics,
            .name in (
              "Newsletters and Digests",
              "Advertising and Promotions",
              "Educational and Research",
              "B2B Cold Outreach",
              "Health and Wellness",
              "Professional and Career Development",
              "Romance",
              "Sexually Explicit Messages",
              "Acts of Violence",
              "Voicemail Call and Missed Call Notifications",
              "News and Current Events",
              "Secure Message",
              "Legal and Compliance"
            )
            and .confidence == "high"
    )
  )
attack_types:
  - "BEC/Fraud"
  - "Callback Phishing"
  - "Credential Phishing"
  - "Extortion"
  - "Malware/Ransomware"
  - "Spam"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Lookalike domain"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "f5f0a18f-bd0f-5b47-b383-7df5e25b73b3"
og_id: "7a470716-a910-566e-9cb0-7a641c0d4b40"
testing_pr: 2952
testing_sha: 4e32aee07430df530d2eed68aff9b44f68969b2a