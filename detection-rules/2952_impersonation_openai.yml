name: "Brand Impersonation: OpenAI"
description: "Detects messages impersonating OpenAI through display name spoofing or lookalike domains, while excluding legitimate OpenAI communications and trusted senders with valid DMARC authentication."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    // Brand impersonation indicators
    strings.icontains(sender.display_name, "openai")
    or strings.icontains(sender.display_name, "chatgpt")
    or any(ml.logo_detect(file.message_screenshot()).brands,
           .name == "OpenAI" and .confidence in ("low")
    )
    // OpenAI copyright footer
    or (
      (
        strings.icontains(body.html.raw, '© 2025 OpenAI, L.L.C.')
        or strings.icontains(body.plain.raw, '© 2025 OpenAI, L.L.C.')
      )
      and (
        strings.icontains(body.html.raw, '3180 18th Street, San Francisco, CA 94110')
        or strings.icontains(body.plain.raw, '3180 18th Street, San Francisco, CA 94110')
      )
    )
    // Typosquatting domains in links
    or any(body.links,
           strings.ilevenshtein(.display_url.domain.root_domain, "openai.com") <= 2
           and .display_url.domain.root_domain != "openai.com"
    )
    or any(body.links,
           strings.ilevenshtein(.display_url.domain.root_domain, "chatgpt.com") <= 2
           and .display_url.domain.root_domain != "chatgpt.com"
    )
  )
  // Sender reputation checks
  and (
    sender.email.domain.root_domain in $free_email_providers
    or not headers.auth_summary.dmarc.pass
    or not headers.auth_summary.spf.pass
    or network.whois(sender.email.domain).days_old < 30
    // Hosting platforms commonly abused for brand impersonation
    or sender.email.domain.root_domain in~ (
      "firebaseapp.com",
      "web.app",
      "appspot.com",
      "herokuapp.com",
      "vercel.app",
      "netlify.app",
      "github.io",
      "cloudflareaccess.com",
      "pages.dev",
      "repl.co"
    )
  )
  // Exclude legitimate OpenAI domains
  and sender.email.domain.root_domain not in~ (
    "openai.com",
    "chatgpt.com",
    "openai.andopen.co",
    "openli.com",
    "openai1.discoursemail.com",
    "crunchbase.com",
    "safebase.co",
    "lucid.co",
    "astronomer.io",
    "visitly.io",
    "rocketmoney.com",
    "psm.knowbe4.com"
  )
  // Negate highly trusted senders unless on hosting platform or DMARC fails
  and (
    sender.email.domain.root_domain not in $high_trust_sender_root_domains
    or not headers.auth_summary.dmarc.pass
    or sender.email.domain.root_domain in~ (
      "firebaseapp.com",
      "web.app",
      "appspot.com",
      "herokuapp.com",
      "vercel.app",
      "netlify.app",
      "github.io",
      "cloudflareaccess.com",
      "pages.dev",
      "repl.co"
    )
  )
  // Negate if in Alexa 1M unless on hosting platform
  and (
    sender.email.domain.root_domain not in $alexa_1m
    or sender.email.domain.root_domain in~ (
      "firebaseapp.com",
      "web.app",
      "appspot.com",
      "herokuapp.com",
      "vercel.app",
      "netlify.app",
      "github.io",
      "cloudflareaccess.com",
      "pages.dev",
      "repl.co"
    )
  )
  // Negate forwarded emails
  and not (
    strings.icontains(subject.subject, "fwd:")
    or strings.icontains(subject.subject, "fw:")
    or strings.icontains(body.current_thread.text, "forwarded message")
    or strings.icontains(body.current_thread.text, "begin forwarded message")
  )
  // Negate replies and legitimate threads
  and (
    length(headers.references) == 0
    or not strings.istarts_with(subject.subject, "re:")
  )
  // Exclude legitimate content types
  and (
    not any(ml.nlu_classifier(body.current_thread.text).topics,
            .name in (
              "Newsletters and Digests",
              "Advertising and Promotions",
              "Educational and Research",
              "B2B Cold Outreach",
              "Health and Wellness",
              "Professional and Career Development",
              "Romance",
              "Sexually Explicit Messages",
              "Software and App Updates",
              "Acts of Violence",
              "Voicemail Call and Missed Call Notifications",
              "News and Current Events",
              "Secure Message",
              "Legal and Compliance"
            )
            and .confidence == "high"
    )
  )
attack_types:
  - "BEC/Fraud"
  - "Callback Phishing"
  - "Credential Phishing"
  - "Extortion"
  - "Malware/Ransomware"
  - "Spam"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Lookalike domain"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "f5f0a18f-bd0f-5b47-b383-7df5e25b73b3"
og_id: "7a470716-a910-566e-9cb0-7a641c0d4b40"
testing_pr: 2952
testing_sha: ebef97d9b93bcd85cf381fd2e01c5cd888ab7c76