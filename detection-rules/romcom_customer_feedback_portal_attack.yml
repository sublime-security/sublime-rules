name: "Operation Deceptive Prospect: RomCom targeting via customer feedback portals"
description: |
  Detects emails that are likely part of the "Operation Deceptive Prospect" campaign carried out by RomCom threat actors.
  This campaign targets customer feedback portals with social engineering complaints (stolen luggage, facility problems)
  and delivers executables disguised as PDF files. The attack uses AI-generated convincing emails and multiple
  redirection stages via URL shorteners to deliver payloads.
reference:
  - "https://www.bridewell.com/insights/blogs/detail/operation-deceptive-prospect-romcom-targeting-uk-organisations-through-customer-feedback-portals"
type: "rule"
severity: "high"
source: |
  type.inbound

  // Looking for complaint-style emails that would be sent to customer service
  and (
    // Subject patterns indicating complaints or feedback
    regex.icontains(subject.subject,
                    '\b(complaint|feedback|issue|problem|concern|lost|stolen|missing|damaged|luggage|bag|suitcase|property|facility|service)\b'
    )
    // Body text patterns typical of the RomCom campaign
    and regex.icontains(body.current_thread.text,
                        '\b(complaint|feedback|issue|problem|concern|lost|stolen|missing|damaged|luggage|bag|suitcase|property|facility|service)\b'
    )
    // Looking for patterns of customer complaints
    and (
      // Complaint language
      regex.icontains(body.current_thread.text,
                      'I am (writing|contacting|reaching out) (to (file|submit|register|lodge) a|regarding a|about a|with a) (complaint|concern|problem|issue)',
                      'I (recently|unfortunately) (experienced|had|encountered) (a|an) (issue|problem|terrible|disappointing|unpleasant) (experience|service)',
                      'I would like to (report|bring to your attention|express my dissatisfaction)',
                      'I am (dissatisfied|disappointed|unhappy|upset) with',
                      'Please (find|see) (attached|enclosed|the attached) (document|file|details|evidence|proof|photo|picture|image)'
      )
      // Specific to RomCom: references to locations, luggage problems, or facility issues
      or regex.icontains(body.current_thread.text,
                         '(my (luggage|bag|suitcase|belongings|items|property) (was|were) (lost|stolen|damaged|misplaced))',
                         '(issue|problem) with (your|the) (facility|building|premises|location|store|branch|airport|hotel)'
      )
    )
  )

  // Check for suspicious links 
  and (
    // Look for links to fake cloud storage domains or URL shorteners
    any(body.links,
        // Matches common domains used in the campaign
        regex.icontains(.href_url.domain.domain,
                        '(cloud|drive|onedrive|gdrive|share|doc|file|view).*\.(live|click|pub|online|site|xyz)',
                        'gcloud-drive\.com'
        )
        // Check for URL shortener services mentioned in the article
        or .href_url.domain.domain in $url_shorteners
    )
    // Or look for attachments with PDF icons but executable content
    or any(attachments,
           // PDF extension but not actually a PDF
           (
             regex.icontains(.file_name, '\.pdf$')
             and (
               any(file.explode(.),
                   .file_extension == "pdf"
                   and not strings.starts_with(.flavors.mime, "application/pdf")
               )
               // Archive that might contain disguised executable
               or (
                 .file_extension in~ $file_extensions_common_archives
                 // Look for PE files
                 and (
                   any(file.explode(.),
                       any(.flavors.yara, . == "mz_file")
                       and strings.starts_with(.flavors.mime, "application")
                   )
                 )
               )
             )
           )
    )
  )

  // Exclude likely legitimate senders
  and sender.email.domain.root_domain not in $org_domains
  // Look for suspicious email patterns mentioned in the article
  and (
    // Suspicious Yahoo email pattern mentioned in article
    regex.icontains(sender.email.email, '[a-z]+\.[a-z]+[0-9]{6}@yahoo\.com')
    // Free email providers often used in these attacks
    or sender.email.domain.root_domain in $free_email_providers
    // New or uncommon sender patterns
    or profile.by_sender().prevalence in ("new", "outlier")
  )

  // Negation for high trust senders
  and (
    (
      sender.email.domain.root_domain in $high_trust_sender_root_domains
      and not headers.auth_summary.dmarc.pass
    )
    or sender.email.domain.root_domain not in $high_trust_sender_root_domains
  )

tags:
  - "RomCom"
  - "Operation Deceptive Prospect"
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Spear phishing"
  - "Impersonation: Brand"
  - "Social engineering"
  - "Evasion"
detection_methods:
  - "Content analysis"
  - "Sender analysis"
  - "URL analysis"
  - "File analysis"