name: "Callback Phishing: Social Security Administration Fraud"
description: "Detects phishing attempts that impersonate the Social Security Administration, using a single PDF attachment containing specific fraud-related language and a callback number."
type: "rule"
severity: "medium"
source: "type.inbound\nand (\n  not profile.by_sender().solicited\n  or (\n    profile.by_sender().any_messages_malicious_or_spam\n    and not profile.by_sender().any_false_positives\n  )\n)\n\n// single attachment\nand length(attachments) == 1\n\n// sender is freemail\nand sender.email.domain.root_domain in $free_email_providers\n\n// the attachment is a pdf with 1 page, and at least 60 ocr chars\nand any(attachments,\n        .file_extension == \"pdf\"\n        and any(file.explode(.), .scan.exiftool.page_count == 1)\n        and any(file.explode(.), length(.scan.ocr.raw) > 60)\n\n        // 4 of the following strings are found        \n        and (\n          any(file.explode(.),\n              4 of (\n                strings.icontains(.scan.ocr.raw, \"fraudulent activity\"),\n                strings.icontains(.scan.ocr.raw, \"Social Security Number\"),\n                strings.icontains(.scan.ocr.raw, \"SSN\"),\n                strings.icontains(.scan.ocr.raw, \"stolen\"),\n                strings.icontains(.scan.ocr.raw, \"illicit activities\"),\n                strings.icontains(.scan.ocr.raw,\n                                  \"Social Security Administration\"\n                ),\n                strings.icontains(.scan.ocr.raw, \"if you are innocent\"),\n                strings.icontains(.scan.ocr.raw, \"help line\"),\n                strings.icontains(.scan.ocr.raw, \"Department of Justice\"),\n                strings.icontains(.scan.ocr.raw, \"innocent\"),\n                regex.icontains(.scan.ocr.raw, '\\$\\d{3}\\.\\d{2}\\b')\n                and (\n                  regex.contains(.scan.ocr.raw,\n                                  '(\\+\\d|1.(\\()?\\d{3}(\\))?\\D\\d{3}\\D\\d{4})'\n                  )\n                  or regex.contains(.scan.ocr.raw,\n                                     '\\+?(\\d{1,2})?\\s?\\(?\\d{3}\\)?[\\s\\.\\-⋅]{0,5}\\d{3}[\\s\\.\\-⋅]{0,5}\\d{4}'\n                  )\n                )\n              )\n          )\n        )\n)\n"
attack_types:
  - "Callback Phishing"
tactics_and_techniques:
  - "Evasion"
  - "Free email provider"
  - "Out of band pivot"
  - "PDF"
  - "Social engineering"
detection_methods:
  - "Exif analysis"
  - "File analysis"
  - "Optical Character Recognition"
  - "Sender analysis"
id: "a9049d52-3611-5b16-8b7c-38cdb639f692"
testing_pr: 1555
testing_sha: 6c0c4a49cd8e532faaf843b9fdebef583b8aa1de
