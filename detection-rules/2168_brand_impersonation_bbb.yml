name: "Brand Impersonation: The Better Business Bureau (BBB)"
description: "Detect impersonation of the Better Business Bureau (BBB) from unsolicited sender"
type: "rule"
severity: "medium"
source: "type.inbound\nand \n// display name contains bbb\n(\n  regex.icontains(strings.replace_confusables(sender.display_name),\n                  '(?:\\bBBB\\b|better business bureau)'\n  )\n  // or levenshtein distance similar to the full name\n  or strings.ilevenshtein(strings.replace_confusables(sender.display_name),\n                          'better business bureau'\n  ) <= 1\n)\n// doesn't contain a link to the legit method of responding to bbb complaints\nand not any(body.links,\n        .href_url.domain.domain == \"respond.bbb.org\"\n        and .href_url.path == \"/respond/\"\n        and .display_url.domain.domain == \"respond.bbb.org\"\n        and .display_url.path == \"/respond/\"\n)\n// and the sender is not from the bbb and passes auth\nand not (\n  (\n    sender.email.domain.root_domain in (\n      \"bbb.org\", \n      \"mybbb.org\", \n      \"bbbcommunity.org\", // official BBB site\n      \"bluebbb.org\", // official BBB site\n      \"thebbb.org\", // official BBB site        \n      \"thefirstbbb.org\",\n      \"bbbnp.org\" // unrelated domain that sends with BBB within the display name\n    )\n   or sender.email.domain.domain in (\n      \"bbbwisegivingalliance.ccsend.com\" // official BBB comms for events\n   )\n )\n  and headers.auth_summary.dmarc.pass\n)\nand ml.nlu_classifier(body.current_thread.text).language == \"english\"\n// and the sender is not from high trust sender root domains\nand (\n  (\n    sender.email.domain.root_domain in $high_trust_sender_root_domains\n    and not headers.auth_summary.dmarc.pass\n  )\n  or sender.email.domain.root_domain not in $high_trust_sender_root_domains\n)\n\n// not solicited\nand not profile.by_sender().solicited\n"
attack_types:
  - "Credential Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Sender analysis"
id: "bc5f4ce5-65c8-5596-a48e-eec1983a2edd"
og_id: "76f54e5f-c937-5693-b8e7-3ced7dac61f9"
testing_pr: 2168
testing_sha: f8b4e3ed0c64a75c775d222af678b6f1e8da3391
