name: "Attachment: PDF generated with wkhtmltopdf tool and default title"
description: "Detects PDF attachments that were generated using the wkhtmltopdf conversion tool, which converts HTML/CSS to PDF. This tool is commonly used by attackers to create legitimate-looking PDF documents from web content for social engineering purposes."
type: "rule"
severity: "low"
source: |
  type.inbound
  and any(filter(attachments, .file_extension == "pdf"),
          strings.istarts_with(beta.parse_exif(.).producer, "Qt")
          and strings.icontains(beta.parse_exif(.).creator, "wkhtmltopdf")
          and beta.parse_exif(.).title == "Document"
  )

attack_types:
  - "BEC/Fraud"
  - "Callback Phishing"
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Exif analysis"
id: "6849b48c-4c79-5d86-ae9a-5e1b7b4f9889"
og_id: "64e6c8a8-b75b-5c43-acb8-765ce05dca36"
testing_pr: 3658
testing_sha: 2c97a262a03c125160dad3ae8f6b8ddb52845c8c