name: "Brand impersonation: Blockchain[.]com"
description: |
  Impersonation of Blockchain[.]com, usually for credential theft.
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    regex.imatch(sender.display_name, '\bblockchain\b')
    or strings.ilevenshtein(sender.display_name, 'blockchain') <= 1
    or strings.ilike(sender.email.domain.domain, '*blockchain.com*')
    or any(body.links,
           strings.ilevenshtein(.href_url.domain.root_domain, 'blockchain') == 1
    )
  )
  and not any(ml.nlu_classifier(body.current_thread.text).topics,
              .name in ("Educational and Research", "Advertising and Promotions")
              and .confidence == "high"
  )
  and not (
    sender.email.domain.root_domain in~ (
      'blockchain.com',
      'wxblockchain.com',
      'ai-blockchain.com',
      'envisionblockchain.com'
    )
    and coalesce(headers.auth_summary.dmarc.pass, false)
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Lookalike domain"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "140a6d79-3c0d-55ea-9c8f-701c89fe66b4"
og_id: "0d85e555-bf7c-50a9-afba-de3c67818b6f"
testing_pr: 3920
testing_sha: 8a13d65037c80381a4424697c245cd1bf567cb68