name: "Brand impersonation: Sharepoint (image as content)"
description: |
  Impersonation of Sharepoint where the image contains the content of the attack.
type: "rule"
severity: "high"
source: |
  type.inbound
  and length(body.links) > 0
  and any(attachments,
      .file_type in ('png', 'jpeg', 'jpg', 'bmp')
      and any(beta.logo_detect(.).brands, .name == "Microsoft SharePoint")

      and any(file.explode(.),
          any(ml.nlu_classifier(.scan.ocr.raw).intents,
              .name == "cred_theft" and
              .confidence == "high"
          )
      )
  )
tags: 
  - "Computer Vision"
  - "Natural Language Understanding"
  - "Brand impersonation"
