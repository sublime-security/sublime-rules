name: "Brand Impersonation: United Healthcare"
description: "Detects messages impersonating United Healthcare (UHC) by analyzing display names that contain variations of 'United Healthcare' or 'UHC', including those with character substitutions. The rule excludes legitimate messages from verified UHC domains that pass DMARC authentication and handles high-trust sender domains appropriately."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    // display name contains UHC
    (
      strings.ilike(strings.replace_confusables(sender.display_name),
                    '*united healthcare*'
      )
      or strings.ilike(strings.replace_confusables(sender.display_name), 'UHC*')
    )
    // levenshtein distance similar to UHC
    or strings.ilevenshtein(strings.replace_confusables(sender.display_name),
                            'united healthcare'
    ) <= 1
  )
  // and the sender is not in org_domains or from UHC domains and passes auth
  and not (
    sender.email.domain.root_domain in $org_domains
    or (
      (
        sender.email.domain.root_domain in (
          "uhc.com",
          "unitedhealthcare.com",
          "uhcmedicaresolutions.com",
          "unitedhealthcareupdate.com",
          "yourhealth-wellnessteam.com",
          "uhc-customer.com"
        )
        or sender.email.email == "uhcomfac@central.uh.edu"
      )
      and headers.auth_summary.dmarc.pass
    )
  )
  // and the sender is not from high trust sender root domains
  and (
    (
      sender.email.domain.root_domain in $high_trust_sender_root_domains
      and not headers.auth_summary.dmarc.pass
    )
    or sender.email.domain.root_domain not in $high_trust_sender_root_domains
  )

attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
id: "f8dfff1a-8f3e-5301-b2d7-b68a78ad34db"
