name: "Malicious Zoom download link or attachment"
description: |
  Impersonation of the video conferencing provider Zoom, encouraging the user to download a fake Zoom client.
references:
  - "https://delivr.to/payloads?id=8cec31fa-105c-4687-bf25-b2c367c56519"
type: "rule"
severity: "high"
source: |
  type.inbound 
  and sender.email.domain.root_domain not in ("zoom.us")
  and (
      body.html.display_text != ""
      and strings.ilike(body.html.display_text, "*zoom*")
      and strings.ilike(body.html.display_text, "*Zoom Client*", "*download*")
      and any(body.links, strings.ilike(.href_url.url, '*exe*', '*msi*', '*zip*'))
    or any(attachments,
          (
              .file_extension in~ ("html", "htm", "shtml", "dhtml") or
              .file_extension in~ $file_extensions_common_archives or
              .file_type == "html"
          )
          and any(beta.binexplode(.),
                  strings.ilike(.scan.html.title, "*zoom*") and
                  any(.scan.url.urls, strings.ilike(.path, '*exe*', '*msi*', '*zip*'))
                )
    )
  )
  or any(body.links,
   // Zoom branding
    beta.linkanalysis(.).credphish.brand.name == "Zoom" and 
    beta.linkanalysis(.).credphish.brand.confidence == "high" and 
    beta.linkanalysis(.).credphish.disposition == "phishing" and 

    // Qakbot text for user coercion
    any(beta.binexplode(beta.linkanalysis(.).screenshot),
        all([
            "download",
            "client"
        ], strings.icontains(..scan.ocr.raw, .))
    )
)
  and (
          (
              sender.email.domain.root_domain in $free_email_providers
              and sender.email.email not in $sender_emails
          )
          or (
              sender.email.domain.root_domain not in $free_email_providers
              and sender.email.domain.domain not in $sender_domains
          )
  )
tags:
  - "Brand impersonation"
