name: "Attachment: Password-protected PDF with fake document indicators"
description: "Detects PDF attachments that are password protected and matching YARA signatures looking for specific content observed in previous activity."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"),
          any(file.explode(.),
              any(.scan.yara.matches, .name == "pwd_protected_pdf_fake_document_1")
              and any(.scan.exiftool.fields,
                      strings.icontains(.value, "password protected")
              )
          )
  )

attack_types:
  - "Malware/Ransomware"
  - "Credential Phishing"
tactics_and_techniques:
  - "Encryption"
  - "Evasion"
  - "PDF"
detection_methods:
  - "File analysis"
  - "YARA"
  - "Exif analysis"