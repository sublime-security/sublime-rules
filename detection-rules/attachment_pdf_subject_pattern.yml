name: "Attachment: PDF with alphanumeric pattern in subject"
description: "Detects messages with a single PDF attachment and a subject line containing a specific alphanumeric pattern (format: XXXX-XXXXXX-XXXX). This pattern is commonly used in malicious campaigns to mimic legitimate document reference numbers or tracking codes."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and length(map(filter(attachments, .content_type == "application/pdf"),
                 .content_type
             )
  ) == 1
  and (regex.icontains(subject.subject, '[0-9A-Z]{4}-[0-9A-Z]{6}-[0-9A-Z]{4}\b'))
attack_types:
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "PDF"
  - "Social engineering"
detection_methods:
  - "File analysis"
  - "Content analysis"
  - "Header analysis"
id: "b6841d13-d9e9-580a-b57b-00720b9096cf"
