name: "Attachment: PDF with specific coordinate rectangle"
description: "Detects PDF attachments containing a specific rectangular coordinate pattern at position [249.75 560 407.25 599.75], which may indicate a templated or malicious document structure."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"),
          any(file.explode(.),
              any(.scan.strings.strings,
                  strings.contains(., "/Rect [ 249.75 560 407.25 599.75 ]")
              )
          )
  )
attack_types:
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Content analysis"
id: "10a157c3-df91-5639-8028-75dc409269e8"
og_id: "c936f7cc-6139-59d6-982d-26e9f523b143"
testing_pr: 4052
testing_sha: 1f4576284fd35f8b2bc28c0e85dc5ae5699c121b