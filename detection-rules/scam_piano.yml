name: "Scam: Piano giveaway"
description: "This rule is designed to identify and mitigate a specific type of fraudulent activity commonly targeted at educational institutions. This rule operates by analyzing incoming email content for certain characteristics indicative of a scam involving the offer of a free piano, often framed within the context of downsizing or a giveaway."
type: "rule"
severity: "medium"
source: "length(body.links) < 10\nand length(body.current_thread.text) < 1500\nand (\n  // items and brands\n  // Guitars\n  strings.ilike(body.current_thread.text,\n                '(?:Gibson|Fender|Lowden|Martin|Taylor|Ibanez)\\s*[^\\r\\n]{0,50}\\s*guitar',\n  )\n  // Piano/Keyboards\n  or regex.icontains(body.current_thread.text,\n                     '(?:Yamaha|Kawai|Baldwin|Roland|Stei?nway(?: (?:&|and) Sons?)?)\\s*[^\\r\\n]{0,50}(?:baby.grand|piano|baby.grand.piano|keyboard)',\n  )\n  // Violins & Orchestral \n  or regex.icontains(body.current_thread.text,\n                     '(?:Stradivarius|Guarneri|Yamaha|Stentor|Eastman|Cremona|Cecilio|Mendini)\\s*[^\\r\\n]{0,50}(violin|viola|cello|celli)',\n  )\n  // brass/wind/woodwinds\n  or regex.icontains(body.current_thread.text,\n                     '(?:Bach|Yamaha|Selmer|Conn|King|Jupiter|Buffet Crampon |Pearl)\\s*[^\\r\\n]{0,50}(trombone|trumpet|saxophone|clarinet|flute)'\n  )\n\n  // generic\n  or strings.ilike(body.current_thread.text, '* musical instruments *')\n)\nand (\n  // often a person is moving\n  strings.ilike(body.current_thread.text,\n                '* downsizing *',\n                '* relocating *',\n                '* relocation *',\n                '* moving *'\n  )\n  or strings.ilike(body.current_thread.text,\n                   '* give away*',\n                   '* generously offering *',\n                   '*a loving home*',\n                   '*find a new home *',\n                   '*rehome these instruments *'\n  )\n  // generally somone died\n  or regex.icontains(body.current_thread.text,\n                     'inherited instruments',\n                     'late (?:husband|father|dad|wife|mother|mom)',\n                     '(?:husband|father|dad|wife|mother|mom)[^\\r\\n]{0,50}estate'\n  )\n  // passion/love for the item\n  or strings.ilike(body.current_thread.text,\n                   '* genuinely cherish *',\n                   '* cherished possessions *',\n                   '* passionate instrument *',\n                   '* had a passion for music *'\n  )\n)\nand (\n  // it talks about a shipping fee upfront\n  regex.icontains(body.current_thread.text,\n                  'shipping (?:fee|cost|arrangement)',\n                  '(?:responsible|pay) for shipping',\n                  'no (?:local\\s)?pick.?up',\n                  'delivery only',\n                  'moving company'\n  )\n  or strings.ilike(body.current_thread.text,\n                   '* if you will take it *',\n                   '* or have someone *',\n                   '* indicate your interest *',\n                   '* to someone you know*'\n                   \n  )\n  or regex.icontains(body.current_thread.text,\n                     'if you (?:will be|are) interested',\n                     'who (?:will|would) appreciate'\n  )\n  or (\n    // there's an email in the body \n    regex.contains(body.current_thread.text,\n                   \"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\\\.[A-Za-z]{2,}\"\n    )\n\n    // and it's likely a freemail\n    and any($free_email_providers,\n            strings.icontains(body.current_thread.text, .)\n    )\n  )\n  // reply-to doesn't match sender\n  or (\n    length(headers.reply_to) > 0\n    and sender.email.email not in map(headers.reply_to, .email.email)\n  )\n  // there are no recipients\n  or length(recipients.to) == 0\n  // redirects to a phone number\n  or regex.icontains(body.current_thread.text,\n                     '(?:call|contact|text)[^\\r\\n]{0,50} at'\n  )\n  or regex.icontains(body.current_thread.text,\n                     '(?:private|personal) (?:e-?)?mail'\n  )\n  or strings.icontains(body.current_thread.text, ' kindly ')\n)\n\n// not high trust sender domains\nand not (\n  sender.email.domain.root_domain in $high_trust_sender_root_domains\n  and headers.auth_summary.dmarc.pass\n)\n// person provides piano lessons and offers to give a Roland baby-grand away\nand not sender.email.domain.root_domain == 'ridleyacademy.com'\n"
attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "Free email provider"
detection_methods:
  - "Content analysis"
  - "Natural Language Understanding"
  - "Sender analysis"
id: "1a91a203-b1fe-52b7-9f71-cecdbf5cdce0"
testing_pr: 2362
testing_sha: 9bf68482b24044a1da5487a781c4d3650c3b7f4e
