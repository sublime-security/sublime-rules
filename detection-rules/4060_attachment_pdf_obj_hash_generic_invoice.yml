name: "Attachment: PDF object hash - generic invoice theme"
description: "Detects PDF attachments containing objects with specific hash values known for generic invoices, typically with the file name 'Payment-#'. The rule identifies PDF files by analyzing their internal object structures and matching against known, harmful object hashes."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"),
          any(file.explode(.),
              .scan.pdf_obj_hash.object_hash in (
                "092325d8f3eb11f3642a9da5c430a0fc",
                "335f56339b6ac9c308a2cc45d0644352"
              )
          )
  )

attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Threat intelligence"
id: "8e64abfa-6fe8-563d-b3e4-a36e3eb34002"
og_id: "d162b2cb-1eab-59d4-9304-65db8426bd5d"
testing_pr: 4060
testing_sha: f37bc52b7b2dfadf81983090c5e3c9b6fbf5e1a1