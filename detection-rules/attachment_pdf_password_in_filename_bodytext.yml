name: "Attachment: PDF with password in filename matching body text"
description: "Detects messages containing a single PDF attachment where the filename includes a numeric password that is explicitly referenced in the message body text."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and length(filter(attachments, .file_type == "pdf")) == 1
  and any(regex.extract(body.current_thread.text, 'password is (?P<pw>[0-9]{1,})'),
      any(filter(attachments, .file_type == "pdf"), 
          strings.contains(.file_name, ..named_groups["pw"])
      )
  )
attack_types:
  - "Malware/Ransomware"
  - "Credential Phishing"
tactics_and_techniques:
  - "Encryption"
  - "Evasion"
  - "PDF"
detection_methods:
  - "Content analysis"
  - "File analysis"
