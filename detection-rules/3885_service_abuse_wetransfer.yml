name: "PR# 3885 - Service abuse: WeTransfer with malicious intent"
description: "Detects legitimate WeTransfer emails that contain callback scam or credential theft language, indicating abuse of the legitimate file sharing service for malicious purposes."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and sender.email.email == 'noreply@wetransfer.com'
  and (
    any(ml.nlu_classifier(body.current_thread.text).intents,
        .name == "callback_scam" and .confidence == "high"
    )
    or any(ml.nlu_classifier(body.current_thread.text).intents,
           .name == "cred_theft" and .confidence == "high"
    )
  )

attack_types:
  - "Callback Phishing"
  - "Credential Phishing"
tactics_and_techniques:
  - "Free file host"
  - "Social engineering"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Natural Language Understanding"
  - "Sender analysis"
id: "4bd7f0d3-9092-5add-802a-6d3870fa7fe1"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_markmsublime
references:
  - https://github.com/sublime-security/sublime-rules/pull/3885