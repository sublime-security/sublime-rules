name: "Attachment with Windows PE"
description: |
  Recursively scans files and archives to detect Windows PE files based on MIME type.
type: "rule"
source: |
  type.inbound
  and any(attachments,
      any(beta.binexplode(.),
      .flavors.mime in (
          'application/vnd.microsoft.portable-executable',
          'application/x-dosexec')
      )
  )
tags:
  - "Suspicious attachment"
