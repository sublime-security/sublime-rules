name: "PR# 3966 - Anthropic Magic String in HTML"
description: "Detects messages containing the specific test string 'ANTHROPIC_MAGIC_STRING' in the plain text body content."
type: "rule"
severity: "low"
source: |
  type.inbound
  and length(attachments) <= 3
  and (
    strings.icontains(body.html.raw, 'ANTHROPIC_MAGIC_STRING_')
    or strings.icontains(body.plain.raw, 'ANTHROPIC_MAGIC_STRING_')
    or strings.icontains(body.html.display_text, 'ANTHROPIC_MAGIC_STRING_')
    or any(attachments,
           any(file.explode(.),
               strings.icontains(.scan.ocr.raw, "ANTHROPIC_MAGIC_STRING_")
               or strings.icontains(.scan.strings.raw, "ANTHROPIC_MAGIC_STRING_")
           )
    )
  )

attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Exploit"
detection_methods:
  - "Content analysis"
id: "9f16a56e-d38c-59a6-bf09-83bd30afb803"
tags:
  - created_from_open_prs
  - rule_status_modified
  - pr_author_IndiaAce
references:
  - https://github.com/sublime-security/sublime-rules/pull/3966