name: "Attachment: PDF with specific coordinate rectangle"
description: "Detects PDF attachments containing a specific rectangular coordinate pattern at position [249.75 560 407.25 599.75], which may indicate a templated or malicious document structure."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"), 
      any(file.explode(.), 
          any(.scan.strings.strings,
              strings.contains(., "/Rect [ 249.75 560 407.25 599.75 ]")
          )
      )
  )

attack_types:
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Content analysis"
