name: "Brand impersonation: the Better Business Bureau (BBB)"
description: "Detect impersonation of the Better Business Bureau (BBB) from unsolicited sender"
type: "rule"
severity: "medium"
source: "type.inbound\nand \n// display name contains bbb\n(\n  regex.icontains(strings.replace_confusables(sender.display_name),\n                  '(?:\\bBBB\\b|better business bureau)'\n  )\n  // or levenshtein distance similar to the full name\n  or strings.ilevenshtein(strings.replace_confusables(sender.display_name),\n                          'better business bureau'\n  ) <= 1\n)\n// and the sender is not in org_domains or from the bbb and passes auth\nand not (\n  sender.email.domain.root_domain in (\"bbb.org\", \"mybbb.org\", \"thefirstbbb.org\")\n  and headers.auth_summary.dmarc.pass\n)\n\n// and the sender is not from high trust sender root domains\nand (\n  (\n    sender.email.domain.root_domain in $high_trust_sender_root_domains\n    and not headers.auth_summary.dmarc.pass\n  )\n  or sender.email.domain.root_domain not in $high_trust_sender_root_domains\n)\n\n// not solicited\nand not profile.by_sender().solicited\n"
attack_types:
  - "Credential Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Social engineering"
detection_methods:
  - "Sender analysis"
id: "76f54e5f-c937-5693-b8e7-3ced7dac61f9"
testing_pr: 2168
testing_sha: 1684cc310fbff23d0c23766c6acd86ead5e74fd8
