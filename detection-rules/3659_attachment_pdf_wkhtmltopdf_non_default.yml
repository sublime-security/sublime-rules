name: "Attachment: PDF generated with wkhtmltopdf without default title"
description: "Detects PDF attachments created using wkhtmltopdf (Qt-based HTML to PDF converter) that have a custom title instead of the default 'Document' title. This technique is commonly used to generate dynamic PDFs from HTML content, which may indicate programmatically created documents for malicious purposes."
type: "rule"
severity: "low"
source: |
  type.inbound
  and any(filter(attachments, .file_extension == "pdf"),
          strings.istarts_with(beta.parse_exif(.).producer, "Qt")
          and strings.icontains(beta.parse_exif(.).creator, "wkhtmltopdf")
          and not beta.parse_exif(.).title == "Document"
  )

attack_types:
  - "BEC/Fraud"
  - "Credential Phishing"
  - "Malware/Ransomware"
tactics_and_techniques:
  - "PDF"
  - "Evasion"
detection_methods:
  - "File analysis"
  - "Exif analysis"
id: "409312d7-5492-547b-9967-05b964adb17e"
og_id: "fe552692-6a7a-5858-a803-ca3e934f22d4"
testing_pr: 3659
testing_sha: 30b04269b10b124ad8717f4e47a7fdab987d4fef