name: "Brand impersonation: Venmo"
description: |
  Impersonation of Venmo
references:
  - "https://whnt.com/taking-action/bbb-consumer-alerts/new-venmo-scam-tricks-users/"
type: "rule"
severity: "medium"
source: |
  type.inbound
  and (
    strings.ilike(sender.display_name, '*venmo*')
    or strings.ilevenshtein(sender.display_name, 'venmo') <= 1
    or strings.ilike(sender.email.domain.domain, '*venmo*')
  )
  and sender.email.domain.root_domain not in~ ('venmo.com', 'synchronybank.com', 'venmocreditsurvey.com', 'venmo-experience.com')
  and sender.email.email not in $recipient_emails
  
  // and not if the sender.display.name contains "via" and dmarc pass from venmo.com
  and not (
    any(distinct(headers.hops, .authentication_results.dmarc is not null),
        strings.ilike(.authentication_results.dmarc, "pass")
        and .authentication_results.dmarc_details.from.domain == "venmo.com"
    )
    and strings.contains(sender.display_name, "via")
  )
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "Impersonation: Brand"
  - "Lookalike domain"
  - "Social engineering"
detection_methods:
  - "Sender analysis"
id: "0ab15d4f-865f-518c-b54d-81043399e6f2"
