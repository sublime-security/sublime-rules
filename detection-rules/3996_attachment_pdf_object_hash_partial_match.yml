name: "Attachment: PDF with specific object hash pattern"
description: "Detects PDF attachments containing a specific object hash string pattern. This may indicate similar build characteristics or templated features."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(filter(attachments, .file_type == "pdf"),
          any(file.explode(.),
              strings.contains(.scan.pdf_obj_hash.hash_string,
                               "Catalog|Pages|Page|Filter|Font/TrueType|FontDescriptor|ExtGState|ExtGState|Font/Type0|None|Font/CIDFontType2|Ordering|FontDescriptor|Font/TrueType|FontDescriptor|Subtype|Subtype|Font/Type0|None|Font/CIDFontType2|Ordering|FontDescriptor|"
              )
          )
  )
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
  - "PDF"
detection_methods:
  - "File analysis"
id: "ea53a4d4-af8b-5a0e-a837-24c4fe3b28d2"
og_id: "39a99174-f2f3-5106-9e99-0684bc7b738c"
testing_pr: 3996
testing_sha: 653f01c807e17c120e10e7098d6c86bef8b7759a