name: "PR# 3892 - Attachment: REG file"
description: "Detects messages containing Windows Registry (.reg) files either as direct attachments or within compressed archives. Registry files can be used to modify system settings and potentially compromise system security."
type: "rule"
severity: "high"
source: |
    type.inbound
    and length(attachments) > 0
    and any(attachments,
            .file_extension =~ "reg"
            or (
              .file_extension in~ $file_extensions_common_archives
              and any(file.explode(.), .file_extension =~ "reg")
            )
    )

attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Scripting"
detection_methods:
  - "Archive analysis"
  - "File analysis"
id: "0d49b936-6a85-5640-9519-f48fdf5e213c"
tags:
  - created_from_open_prs
  - rule_status_added
  - pr_author_peterdj45
references:
  - https://github.com/sublime-security/sublime-rules/pull/3892