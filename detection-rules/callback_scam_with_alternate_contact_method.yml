name: "Callback scam with alternate contact method"
description: "Detects messages with subjects formatted as names or urgent phrases, combined with content suggesting contact through alternate phone lines or numbers, indicating potential callback fraud schemes."
type: "rule"
severity: "medium"
source: |
    type.inbound
    // subject is formatted as a name 'Amy Reffkin' or other similar two word phrase like 'Action Required'
    and regex.contains(subject.base,
                       '^(?:(?:R[eE]:\s*)?[A-Z][a-z]+ [A-Z][a-z]+$'
    )
    and (
      // lure phrase indicates contact on an alternate line/mobile/number
      regex.icontains(body.current_thread.text,
                      '(?:additional|second|extra|alternate|backup|spare|companion|supplemental|auxiliary|added|another)\s+(?:line|phone|number|mobile)\b|\bline\s*2\b|\b(?:second|additional|extra|alternate|backup|spare|secondary|other)\s+number\b|\b(?:additional|extra|second)\s+mobile\s+(?:line|phone|number|mobile)\b|\b(?:additional|extra|second)\s+phone\s+(?:line|phone|number|mobile)\b|\b(?:additional|second|extra|backup|secondary)\s+sim(?:\s+(?:line|phone|number|mobile))?\b|\bdual\s+sim\s+(?:line|phone|number|mobile)\b|\b(?:second|additional|extra|secondary)\s+cellular\s+(?:line|phone|number|mobile)\b|\b(?:additional|extra|secondary)\s+wireless\s+(?:line|phone|number|mobile)\b|\b(?:second|additional)\s+wireless\s+number\b|\bline\s+on\s+the\s+same\s+account\b|\b(?:additional|extra|secondary)\s+account\s+(?:line|phone|number|mobile)\b|\b(?:second|additional)\s+subscription\s+(?:line|phone|number|mobile)'
      )
      or regex.icontains(subject.base,
                         // urgency phrases in subject
                         "(?:Must-address|reach out|needing your follow|Toolbox talk|TO DO JOB|Hot item|urgent|asap|immediate|now|critical|emergency|time[ -]*sensitive|priority|high[ -]*priority|pressing|prompt|rapid|swift|quick|fast|instant|pending|overdue|escalate|escalation|deadline|due|imminent|approaching|soon|rush|rushed|expedited|expedite|must|required|necessary|mandatory|action[ -]*needed|attention|alert|warning|severe|serious|acute|crucial|vital|top[ -]*priority|important|immediate[ -]*action|act[ -]*now|don'?t[ -]*delay|hurry|stat|without[ -]*delay)"
      )
      or regex.icontains(sender.display_name,
                         // urgency phrases in sender display name
                         "(?:Must-address|reach out|needing your follow|Toolbox talk|TO DO JOB|Hot item|urgent|asap|immediate|now|critical|emergency|time[ -]*sensitive|priority|high[ -]*priority|pressing|prompt|rapid|swift|quick|fast|instant|pending|overdue|escalate|escalation|deadline|due|imminent|approaching|soon|rush|rushed|expedited|expedite|must|required|necessary|mandatory|action[ -]*needed|attention|alert|warning|severe|serious|acute|crucial|vital|top[ -]*priority|important|immediate[ -]*action|act[ -]*now|don'?t[ -]*delay|hurry|stat|without[ -]*delay)"
      )
    )
attack_types:
  - "BEC/Fraud"
  - "Callback Phishing"
tactics_and_techniques:
  - "Social engineering"
  - "Out of band pivot"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
id: "cf4d9ad5-9df2-51b0-8a93-22767c1a8721"
