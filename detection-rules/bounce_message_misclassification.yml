name: "Bounce Message: Automatic Misclassification"
description: |
  Identifies bounce messages (undeliverable mail) that should be classified as "Misclassification"
  rather than any other attack category. This helps improve classification accuracy by
  filtering out system-generated bounce notifications.
type: "rule"
severity: "info"
source: |
  type.inbound
  and subject icontains~ ("undelivered", "mail returned", "delivery status", "failed delivery", 
                          "delivery failure", "mail delivery failed", "mail delivery system", 
                          "undeliverable", "bounce", "delivery notification", "returned mail")
  and (
    headers.contains("x-failed-recipients")
    or headers.contains("x-ms-exchange-message-is-ndr")
    or headers.contains("auto-submitted")
    or from icontains~ ("mailer-daemon", "postmaster", "maildeliverysystem", "mail-daemon", "mail-delivery", "no-reply")
  )
tags:
  - "Misclassification"
detection_methods:
  - "Message header analysis"
  - "Subject analysis"