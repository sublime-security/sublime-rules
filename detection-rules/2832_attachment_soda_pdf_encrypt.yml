name: "Attachment: Soda PDF Producer with Encryption Themes"
description: "Detects an observed TTP of using Soda PDF (which offers a free trial) to produce PDFs which OCR output contains references to encryption and mentions a PDF.  The PDF contains a single link which has been observed linking to a credential phishing page."
type: "rule"
severity: "high"
source: "type.inbound\nand any(attachments,\n        .file_extension == \"pdf\"\n        // observed producer\n        and any(file.explode(.), .scan.exiftool.producer == \"Soda PDF\")\n        and any(file.explode(.),\n                // OCR contains \"encryption\" themes\n                (\n                  strings.icontains(.scan.ocr.raw, \"has been encrypted\")\n                  or strings.icontains(.scan.ocr.raw, \"encrypted pdf file\")\n                  or strings.icontains(.scan.ocr.raw, \"is secured by\")\n                )\n                // mentions a PDF \n                and strings.contains(.scan.ocr.raw, \"PDF\")\n        )\n)\n"
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "PDF"
  - "Social engineering"
detection_methods:
  - "File analysis"
  - "Optical Character Recognition"
id: "6f2a7418-d86b-5e65-bbf7-32f5e9f7081a"
og_id: "af8eeca4-825a-5118-bba0-ab62425a5fcb"
testing_pr: 2832
testing_sha: b79a4e5bc8c815eb547301b965c31745d8973221
