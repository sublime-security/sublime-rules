name: "Attachment: Any HTML file (credential phishing)"
description: |
  HTML attachments are commonly used in credential phishing attacks.
  This rule classifies any message with an HTML attachment as credential phishing.
  Use if you want to block or flag all HTML attachments as credential theft attempts.
references:
  - "https://ired.team/offensive-security/defense-evasion/file-smuggling-with-html-and-javascript"
type: "rule"
severity: "medium"
source: |
  type.inbound
  and any(attachments, .file_extension in~ ('htm', 'html') 
    or .file_type == "html" 
    or .content_type icontains "text/html" 
    or .file_name iendswith~ ('.htm', '.html')
  )
tags:
  - "Attack surface reduction"
tactics_and_techniques:
  - "Credential theft"
  - "HTML smuggling"
detection_methods:
  - "File analysis"
  - "HTML analysis"