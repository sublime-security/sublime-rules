name: "Headers: WordPress mailer from unsolicited sender"
description: "Detects messages sent using WPMailSMTP from senders who have not previously been communicated with by the organization."
type: "rule"
severity: "medium"
source: |
  type.inbound
  and not profile.by_sender().solicited
  and strings.starts_with(headers.mailer, 'WPMailSMTP')
tags:
 - "Attack surface reduction"
attack_types:
  - "Credential Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
