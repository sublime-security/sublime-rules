attack_types:
- Credential Phishing
- Brand Impersonation
description: 'Detects sites that mimic the payment process of the PagoPA platform
  established by the Italian Government for payments to public administrations.

  The kit uses the Cleave JS library to validate credit card numbers and dates.


  Converted from IOK rule - original focuses on website analysis.'
detection_methods:
- Header analysis
- Sender analysis
- URL analysis
- Content analysis
- Natural Language Understanding
id: 877af070-3b76-498e-bf30-2851a6eea846
name: 'IOK: PagoPA Phishing Kit 019638cd'
references:
- https://cert-agid.gov.it/wp-content/uploads/2025/04/pagoPA.json
- https://urlscan.io/result/019638cd-0a40-76fc-8fe0-4bcd550f9c0f
- https://urlscan.io/result/01963b32-dccf-75d1-bfc9-00807a035688
severity: high
tactics_and_techniques:
- 'Impersonation: Brand'
tags:
- IOK_Converted
- kit
- target_country.italy
- target.pagopa
type: triage
source: |
  type.inbound
    and any(triage.flagged_rules, any(.detection_methods, ..name == "URL analysis"))
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "cleave.min.js")
    )
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "function isInputNumber(evt)")
    )
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "pagamento")
      and strings.icontains(ml.link_analysis(.).final_dom.raw, "pagopa")
      and strings.icontains(ml.link_analysis(.).final_dom.raw, "action=\"logz/log.php\"")
    )
    and (
      strings.icontains(subject.subject, "account")
      or strings.icontains(subject.subject, "verify")
      or strings.icontains(subject.subject, "suspended")
    )
    and (
      not profile.by_sender().solicited
      or (
        profile.by_sender().any_messages_malicious_or_spam
        and not profile.by_sender().any_messages_benign
      )
    )
