attack_types:
- Credential Phishing
description: 'To evade static analysis, the document body can returned hex encoded
  in the response

  where JavaScript can decode it and append it to the DOM.


  This helps defeat simple scanners which don''t evaluate JavaScript.


  Converted from IOK rule - original focuses on website analysis.'
detection_methods:
- Content analysis
- Header analysis
- URL analysis
- Sender analysis
id: c2cb91c6-619a-42ce-af01-b407d99b597a
name: 'IOK: Hex-encoded document body'
severity: high
tactics_and_techniques:
- Social engineering
tags:
- IOK_Converted
- anti-analysis
type: triage
source: |
  type.inbound
    and any(triage.flagged_rules, any(.detection_methods, ..name == "URL analysis"))
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "document.write(unescape(")
    )
    and (
      strings.icontains(subject.subject, "account")
      or strings.icontains(subject.subject, "verify")
      or strings.icontains(subject.subject, "suspended")
    )
