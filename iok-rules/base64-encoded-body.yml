attack_types:
- Credential Phishing
description: 'To evade static analysis, the document body can returned base64 encoded
  in the response

  where JavaScript can decode it and append it to the DOM.

  This helps defeat simple scanners which don''t evaluate JavaScript.


  Converted from IOK rule - original focuses on website analysis.'
detection_methods:
- Content analysis
- Header analysis
- URL analysis
- Sender analysis
id: 63c7b310-c868-472d-8a8b-a88c07589376
name: 'IOK: Base64-encoded document body'
references:
- https://urlscan.io/result/3b445b90-5d04-4b36-b29a-cdee4bf9a28e
- https://urlscan.io/search/#hash%3A71f119e31661198a11f2c5a24f9a3e01c4b405413efde35a7fb838beb15611df
severity: high
tactics_and_techniques:
- Social engineering
tags:
- IOK_Converted
- anti-analysis
type: triage
source: |
  type.inbound
    and any(triage.flagged_rules, any(.detection_methods, ..name == "URL analysis"))
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "document.write(atob(")
    )
    and (
      strings.icontains(subject.subject, "account")
      or strings.icontains(subject.subject, "verify")
      or strings.icontains(subject.subject, "suspended")
    )
