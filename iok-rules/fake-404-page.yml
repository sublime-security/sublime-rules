attack_types:
- Credential Phishing
description: 'A common way for phishing sites to avoid detection is by presenting
  a fake 404 error page when requested using the "wrong" User Agent (or from the wrong
  GeoIP location).


  These fake error pages exactly mimic the HTML of an Apache 404 page, but unless
  the threat actor has configured their site to hide it, there''s two giveaways it''s
  fake:

  - It sends an `X-Powered-By: PHP` header

  - It sets a `PHPSESSID` cookie


  These are both clear evidence that the 404 page has been generated by PHP and not
  by Apache.


  Converted from IOK rule - original focuses on website analysis.'
detection_methods:
- Header analysis
- URL analysis
- Content analysis
- Sender analysis
id: a758bba0-793f-4903-83e2-0b9b86eebc57
name: 'IOK: Fake Not Found page'
severity: high
tactics_and_techniques:
- Social engineering
tags:
- IOK_Converted
- cloaking
type: triage
source: |
  type.inbound
    and any(triage.flagged_rules, any(.detection_methods, ..name == "URL analysis"))
    and any(body.links,
      strings.icontains(ml.link_analysis(.).final_dom.raw, "<title>404 Not Found</title>")
      or strings.icontains(ml.link_analysis(.).final_dom.raw, "<p>The requested URL was not found on this server.</p>")
    )
    and (
      strings.icontains(headers.hops, "X-Powered-By: PHP")
    )
    and (
      strings.icontains(subject.subject, "account")
      or strings.icontains(subject.subject, "verify")
      or strings.icontains(subject.subject, "suspended")
    )
    and (
      not profile.by_sender().solicited
      or (
        profile.by_sender().any_messages_malicious_or_spam
        and not profile.by_sender().any_messages_benign
      )
    )
