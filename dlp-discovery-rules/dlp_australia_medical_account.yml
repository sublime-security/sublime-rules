name: "DLP: Australia Medical Account Number"
description: "Detects messages containing Australian Medicare numbers."
type: "dlp"
severity: "high"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // Medicare: 10 digits (XXXX XXXXX X format)
          regex.contains(., '\b\d{4}\s?\d{5}\s?\d\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'medicare|medical\s+account')
  )

detection_methods:
  - "Content analysis"
