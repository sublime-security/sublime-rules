name: "DLP: Mexico CURP Number"
description: "Detects messages containing Mexican Unique Population Registry Code (CURP)."
type: "dlp"
severity: "high"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // CURP: 18 alphanumeric characters
          regex.contains(., '\b[A-Z]{4}\d{6}[HM][A-Z]{5}[0-9A-Z]\d\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'CURP|clave\s+única|población')
  )

detection_methods:
  - "Content analysis"
