name: "DLP: JSON Web Token (JWT)"
description: "Detects messages containing JSON Web Tokens."
type: "rule"
severity: "medium"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // JWT format: base64.base64.base64
          regex.contains(., '\beyJ[A-Za-z0-9_-]+\.eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\b')
  )

detection_methods:
  - "Content analysis"
