name: "DLP: Ireland Personal Public Service (PPS) Number"
description: "Detects messages containing Irish Personal Public Service Numbers."
type: "dlp"
severity: "high"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // Irish PPS: 7 digits + 1-2 letters (e.g., 1234567A or 1234567AB)
          regex.contains(., '\b\d{7}[A-Z]{1,2}\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'PPS|personal\s+public\s+service')
  )

detection_methods:
  - "Content analysis"
