name: "DLP: IP Address"
description: "Detects messages containing IP addresses (IPv4 and IPv6)."
type: "dlp"
severity: "low"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // IPv4 address
          regex.contains(., '\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b')
          // IPv6 address
          or regex.contains(., '\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'ip\s+address|server|network|infrastructure')
  )

detection_methods:
  - "Content analysis"
