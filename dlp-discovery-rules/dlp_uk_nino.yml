name: "DLP: UK National Insurance Number (NINO)"
description: "Detects messages containing UK National Insurance Numbers."
type: "dlp"
severity: "high"
source: |
  type.outbound
  and any([body.current_thread.text, subject.subject],
          // NINO: 2 letters + 6 digits + 1 letter (e.g., AB123456C)
          regex.contains(., '\b[A-CEGHJ-PR-TW-Z][A-CEGHJ-NPR-TW-Z]\d{6}[A-D]\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'NINO|national\s+insurance|NI\s+number')
  )

detection_methods:
  - "Content analysis"
