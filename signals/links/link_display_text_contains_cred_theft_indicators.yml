name: "Link: Display Text Contains Credential Phishing Indicators"
type: "query"
source: |
  any(body.links,
      regex.icontains(.display_text,
                      'view.(attachment|download|file|document|message)s?'
      )
  )
  or any(body.links,
        regex.contains(.display_text,
                        '(\\bVIEW|DOWNLOAD|CHECK|KEEP.(SAME|MY)|VERIFY|ACCESS)'
        )
  )
