name: "Sender: Legitimate secure message senders"
type: "query"
source: |  
  (
    // Known secure mailer(s)
    all(body.links,
                .href_url.domain.root_domain in ("mimecast.com", "cisco.com")
    )
    or any(headers.hops,
            .index == 0
            and any(.fields,
                        strings.contains(.value,
                                        'multipart/mixed; boundary="PROOFPOINT_BOUNDARY_1"'
                        )
            )
    )
    or (
      any(headers.hops, any(.fields, .name == 'X-ZixNet'))
      and any(headers.domains,
              .root_domain in ("zixport.com", "zixcorp.com", "zixmail.net")
      )
    )
  ) 
