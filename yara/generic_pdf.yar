rule pwd_protected_pdf_fake_document_1
{
    meta:
        author = "kyle eaton"
        description = "password protected PDF matching several observed lures. Rule is looking at a few of the object nubmer/object type pairs that we saw consistent across the samples. "
    strings:
        $header = {25 50 44 46 2d 31 2e}
        $s1 = {31 33 20 30 20 6F 62 6A 0A 3C 3C 20 20 2F 54 79 70 65 20 2F 43 61 74 61 6C 6F 67} // object 13 is type catalog
        $s2 = {35 20 30 20 6F 62 6A 0A 3C 3C 2F 54 79 70 65 20 2F 46 6F 6E 74} // object 5 is type font
        $s3 = {36 20 30 20 6F 62 6A 0A 3C 3C 2F 54 79 70 65 20 2F 41 6E 6E 6F 74 20 2F 53 75 62 74 79 70 65 20 2F 4C 69 6E 6B 20 2F 52 65 63 74 } // object 6 is link annot with rect
        $s4 = {37 20 30 20 6F 62 6A 0A 3C 3C 2F 54 79 70 65 20 2F 41 6E 6E 6F 74 20 2F 53 75 62 74 79 70 65 20 2F 4C 69 6E 6B } // obj 7 is link annot with rect.
    condition:
        $header at 0
        and all of ($s*)
}

rule w9_pdf_01 {
    meta:
        author = "kyle eaton"
        date = "2026-01-23"
        description = "matching PDF observed in fake w9/invoice campaigns. Focusing on some of the object values found in the w9 lures."
    strings:
        $header = {25 50 44 46 2D 31 2E}
        $lw_01 = {2F 4C 57 20 31 2E 35 32 36 39 39 39 39 35 0A 2F 4D 4C 20 31 30} 
        $lw_02 = {2F 4C 57 20 2E 37 36 33 30 30 30 30 31 0A 2F 4D 4C 20 31 30}
        $lw_03 = {2F 4C 57 20 31 2E 31 34 34 39 39 39 39 38 0A 2F 4D 4C 20 31 30} 
    condition:
        $header at 0
        and any of ($lw_*)
}

rule invoice_pdf_01 {
    meta:
        author = "kyle eaton"
        date = "2026-01-23"
        description = "matching PDF observed in fake w9/invoice campaigns. This focuses on the images found in some of the invoice lures."
    strings:
        $header = {25 50 44 46 2D 31 2E}
        $jpg_jump_logo_dots = {ffc00011080062006b03011100021101031101ffc401a20000010501010101010100000000000000000102030405060708090a0b100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9fa0100030101010101010101010000000000000102030405060708090a0b1100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00fb2a801a7ad00148635dd5177310aa3a9270055589b90c57b69348522ba85d8750ae0d3b315c9cfd718a929115c5c43026e9a448d47766c53b0362db5c433a6e8658e41eaad9a2c24ee4a7839ebed486567bfb28e6f2}
        $jpg_jump_page_break = {ffc00011080004034f03011100021101031101ffc401a20000010501010101010100000000000000000102030405060708090a0b100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9fa0100030101010101010101010000000000000102030405060708090a0b1100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00fb09ad7314b1fda2e0798dbb707e57d87a0a007f93fbff0037cd97ee6dd9bbe5fae3d680182d711471fda2e0ec6ddb8bf2dec4f71400a6df2d31f3a61e68c6037dcff77d28014418684f9d31f28631bb87ff007bd680}
        $jpg_jump_logo_geo = {ffc0001108007e008403011100021101031101ffc401a20000010501010101010100000000000000000102030405060708090a0b100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9fa0100030101010101010101010000000000000102030405060708090a0b1100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00fb2a800a002800a002800a002800a002800a002800a002800a002800a002800a002800a002800a002800a002800a002800a0028029eaba9586976a6e750ba8ede21ddcf5f603b9a00f34d7fe23dc5fea10d8e8a8d6d6}
    condition:
        $header at 0
        and any of ($jpg_*) 
}

rule view_document_pdf_characteristics
{
    meta:
        author = "kyle eaton"
        description = "PDF contains generic lure image characteristics. 'VIEW DOCUMENT HERE' with blurred document image present."
    strings:
        $header = {25 50 44 46 2D 31 2E}
        $image_w = "/Width 1200"
        $image_h = "/Height 1067"
        $uri = "/URI"
        $mb = "/MediaBox [0 0 612 792]"
        $prod = "/Producer"
    condition:
        $header at 0
        and $mb
        and $prod
        and $uri
        and @image_h == @image_w + 12

}

rule pdf_suspicious_image_001
{
    meta:
        author = "kyle eaton"
        description = "PDF contains a suspicious 'confidential' notice image observed in phishing campaigns."
    strings:
        $header = {25 50 44 46 2d 31 2e}
        $jpg_confidential_notice = {ffc00011080052026f03012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00eef59bdbdb148e5b78e078de58e2c48c4105dc2e78edc8aad2eb8f63a8cb6f7e836476f1cacd023305dcce0927d30abfad69dfd9a5f42913b32849639415f5460c07e62abdee9115e3de33c8ebf6a81606c6380a58e4}
        $jpg_pinkish_lure = {ffc00011080182039a03012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00e7e8 [ 344 ] 7a00326b7347f0d4f7b17daef241696639323f048f6abb2ebfa668ea60d0ed11e41c1b990673f4a2e62eaebcb057653b2f096a7708249c25a45fde98e0fe5564e95e19b0e2f7557b871d5211c7e95857da9df6a0}
    condition:
        $header at 0
        and any of ($jpg*)
}