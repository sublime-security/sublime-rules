name: "Fake message thread"
type: "query"
source: | 
  type.inbound
  and regex.icontains(subject.subject, '\b(?:RE|FWD?)\s*:')
  and (
    (length(headers.references) == 0 and headers.in_reply_to is null)
    or not any(headers.hops, any(.fields, strings.ilike(.name, "In-Reply-To")))
  )
severity: "medium"
