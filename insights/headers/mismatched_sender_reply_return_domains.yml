name: "Sender, reply-to, and return path domains are distinct"
type: "query"
source: |
  type.inbound
  and all(headers.reply_to, .email.domain.root_domain != sender.email.domain.root_domain)
  and all(headers.reply_to, .email.domain.root_domain != headers.return_path.domain.root_domain)
  and sender.email.domain.root_domain != headers.return_path.domain.root_domain
severity: "medium"
tags:
  - "Suspicious headers"
